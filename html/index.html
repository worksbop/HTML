<iframe loading="lazy src"="https://booking.dan-cinnamon.com/pablic/customer width="560" allowfullscreen frameborder="0">
</iframe>
 
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Suv-Jet Booking Panel</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.css" rel="stylesheet">
    <link rel="shortcut icon" href="favicon.ico">
    <link href="../css/bootstrap-select.css" rel="stylesheet">
    <style type="text/css">
    
       </style>
</style>
<style type="text/css">.btn {border-radius: 0px;}
    input.form-control {border-radius: 0px;background-color: #fff; color: #000; }
    #MMBLoginBody {background-color: #fff;}
    #MMBLoginBody {color: #000;}
    .modal-header-primary {color: #ffffff; background-color: #0866c6;}.btn-next, .btn-next.dropdown-toggle,.open button.btn-next.dropdown-toggle, .open button.btn-next.dropdown-toggle:focus {border-color: #2d2d2d; background-color: #2d2d2d; color: #ffffff;}
    </style>
</head>
<body id="requirementsBody">
    <form method="post" action="./requirementsBS.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTc0NjkwNzAxMQ9kFgYCAw9kFgICAw8WAh4HVmlzaWJsZWhkAgcPFgIeCWlubmVyaHRtbAUSTG9hZGluZyBGbGlnaHRzLi4uZAIJDxYCHwEFC1BsZWFzZSBXYWl0ZGQZ/b7Myfo68EjLFMQmusLLCN2XnYMWAT7MfzuXS6Miwg==">
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="DD9D2F9C">
</div>
    <input type="hidden" id="refreshed" value="no">
    <input type="hidden" id="VarsSessionID" name="VarsSessionID" value="b0a3e04b-f572-4f0c-9528-d1dc5d6949bd" class="">


    
        
        
    <div id="divRequirementsPanel" class="divRequirementsPanel form-body form-horizontal"><div class="panel panel-default">
<div class="panel-body">
<input type="hidden" id="rqtm" name="rqtm" value="637594472809126930" class="">
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Origin" id="Origin" class="form-control"><option value="LVI">LIVINGSTONE HARRY MWANGA  (LVI)</option><option value="LUN" selected="selected">LUSAKA KENNETH KAUNDA (LUN)</option><option value="MNS">MANSA (MNS)</option><option value="NLA">NDOLA (NLA)</option>
</select></div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Destination" id="Destination" class="form-control"><option value="LUN">LUSAKA (LUN)</option></select></div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<div class="col-md-12">
<div class="btn-group btn-group-sm" data-toggle="buttons"><label class="btn btn-default btn-outline btn-rounded active"><input name="ReturnTrip" id="ReturnTrip1" type="radio" checked="checked" value="chkJourneyTypeReturn"><i class="fa fa-exchange"></i> Return</label><label class="btn btn-default btn-outline btn-rounded"><input name="ReturnTrip" id="ReturnTrip2" type="radio" value="chkJourneyTypeOneWay"><i class="fa fa-long-arrow-right"></i> One Way</label></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group ">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="departuredate" name="departuredate" value="16-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="returndate" name="returndate" value="20-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfAdults" id="NumberOfAdults" class="form-control paxSelectControl"><option selected="selected" id="Adults_1" value="1">1 Adults</option><option id="Adults_2" value="2">2 Adults</option><option id="Adults_3" value="3">3 Adults</option><option id="Adults_4" value="4">4 Adults</option><option id="Adults_5" value="5">5 Adults</option><option id="Adults_6" value="6">6 Adults</option><option id="Adults_7" value="7">7 Adults</option><option id="Adults_8" value="8">8 Adults</option><option id="Adults_9" value="9">9 Adults</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfChildren" id="NumberOfChildren" class="form-control paxSelectControl"><option selected="selected" id="Children_0" value="0">0 Children</option><option id="Children_1" value="1">1 Children</option><option id="Children_2" value="2">2 Children</option><option id="Children_3" value="3">3 Children</option><option id="Children_4" value="4">4 Children</option><option id="Children_5" value="5">5 Children</option><option id="Children_6" value="6">6 Children</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfInfants" id="NumberOfInfants" class="form-control paxSelectControl"><option selected="selected" id="Infants_0" value="0">0 Infants</option><option id="Infants_1" value="1">1 Infants</option><option id="Infants_2" value="2">2 Infants</option><option id="Infants_3" value="3">3 Infants</option><option id="Infants_4" value="4">4 Infants</option><option id="Infants_5" value="5">5 Infants</option><option id="Infants_6" value="6">6 Infants</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="input-group  input-group-sm">
<input class="form-control" type="text" id="EVoucher" placeholder="EVoucher" name="EVoucher"><span class="input-group-addon"><i class="fa fa-tag"></i></span></div>
</div>
</div>
</div>
<div class="panel-footer">
<div class="row">
<div class="col-md-12 text-center">
<div class="input-group  input-group-sm">
<button id="submitButton" class="btn btn-default btn-next" type="submit">Continue</button></div>
</div>
</div>
</div>
</div>
</div>
    <div id="GrandMasterDialog"></div>
    <div id="RequirementsLoadingProgressDialog"></div>
    </form>
       <div id="dialog-message" style="display: none;" title="Information">
        <p>
            <span id="msgSpan">Searching for flights</span>
            <br><br>
        </p>
            <div class="LoadingProgressImage"></div>
    </div>


    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-json/2.5.1/jquery.json.min.js"></script>
    <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script type="text/javascript">/*
    Flights.js
*/
var fareClassMatch = '';
var ClassBandMustMatch = false;
var UseTraditionalReturnFares = false;

var FlightSelectTranslations = null;
var RequirementsPageTranslations = null;
var divNextPreviousDayAvailability = null;
var mmbChangeFlightMode = '';
var oFirstJourneySelected = null;
var oPreviousFirstJourneyFareSelected = null;
var RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": false };
var FlightSelectNextPage = "BookingOptions.aspx";
var FlightSelectAirMilesValidated = false;
var sEVoucher = "";
var RequirementsEarliestBookingDate = null;
var sOriginCityCode = "";
var sDestinationCityCode = "";
var sHomeCityCode = "";
var sDepartureDate = "";
var sReturnDate = "";
var dDefaultDepartureDate = null;
var dDefaultReturnDate = null;
var RequirementsDefaultDepartureDate = null;
var RequirementsDefaultReturnDate = null;
var RequirementsDoOneShot = null;
var AvUrl = "../WebServices/AvailabilityWS.asmx/GetFlightAvailability";
var DestCityUrl = "../WebServices/Airports.asmx/DestinationCityList";
var addFltUrl = "WebServices/AvailabilityWS.asmx/AddFlightToBasket";
var changeDayUrl = "WebServices/AvailabilityWS.asmx/ChangeDay";

function InitAvailabilityDisplay() {
    try {
        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").parent().unbind("click").click(function () {
            //SelectAvailabilityFare(jQuery(this));
            var rb = $(this).find("input[id^=optCalendarAvailabilityFare][type=radio]");
            $(rb).prop('checked', true);
            SelectAvailabilityFare(jQuery(rb));
            //return false;
        });

        $("#radio-jquery-ui").buttonset();

        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").unbind("click").click(function () {
            //    SelectAvailabilityFare(jQuery(this));
            //  return false;
        });

        /*
        $(".refineSearchType").unbind("click").click(function () {
            var rb = $(this).find("input[id=ReturnTrip][type=radio]");
            $(rb).prop('checked', true);
           // return false;
        });
        */

        jQuery("div[id^=divFlightAvailabilityPreviousDay], div[id^=divFlightAvailabilityNextDay]").unbind("click").click(function () {
            NextDayPreviousDay_onClick(jQuery(this));
        });


        if (ClassBandMustMatch) {
            if (fareClassMatch !== '') {
                HideOrDisableUnwantedFares('');
            } else {
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 0) {
                    var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                    HideOrDisableUnwantedFares(tempFareData);
                }
            }
        }

        InitialiseRefineSearch(null);
        InitialiseGenericRefineSearch();
    } catch (e) { var xa = 1;}

}
function InitialiseGenericRefineSearch() {
    try {
        $('.dropdown-menu input, .dropdown-menu label, .dropdown-menu select').click(function (e) {
            e.stopPropagation();
        });
    } catch (e) { var xb = 1;}


    try {
        //if (jQuery("div[id$=RefineSearchWhoIsTravelling]").length == 1) {
        jQuery("#NumberOfAdults").change(function () {
            var noAdultsSelected = parseInt(jQuery(this).val());

            if (noAdultsSelected < 0) { noAdultsSelected = 0; }
            if (jQuery("#NumberOfInfants").length > 0) {
                var fldInfants = jQuery("#NumberOfInfants");
                var noOptions = fldInfants.children().length;

                noAdultsSelected += 1;
                if (noOptions > (noAdultsSelected)) {
                    fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
                } else {
                    for (var i = noOptions; ((i < noAdultsSelected) && (i <= RequirementsProperties.MaxInfants)) ; i++) {
                        fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                    }
                }
            }
        });
        //}
    } catch (e) { var xc = 1; }
}
function AddFlightToBasket_onSuccess(msg) {
    if ( msg !== null &&  msg.Data !== "" ) {
        $("#divBasket2").html(msg.Data);
        try { $("#divMiniBasket").html(msg.Data2); } catch (e) { var x4 = 1;}
        try { $("#BandText").html(msg.DialogCaption); } catch (e) { var x3 = 1; }
        try { InitBasket(); } catch (e) { var x = 1;}
        try { OnPageLoad(); } catch (e) { var x1 = 1; }
    }
   // RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
}

function AddFlightToBasket_onError(ErrorMsg) {

    var dlgMsg = new Object;
    dlgMsg.OkAction = "RefreshPage()";
    dlgMsg.html = ErrorMsg;

    modalDialog(dlgMsg);

        //var oButtons = { "Ok": function() {           
        //    // refresh page
        //    //window.location.reload(true);
        //    RefreshPage();
        //    jQuery(this).dialog("destroy");
        //    }
        //};
        //if (RequirementsPageTranslations != null) {
        //    ShowModalDialog(ErrorMsg, RequirementsPageTranslations.ErrorSelectingFlights, 0, 0, oButtons);
        //} else {
        //    ShowModalDialog(ErrorMsg, "Warning", 0, 0, oButtons);
        //}

}

function HideOrDisableUnwantedFares(tempFareData) {
    // disable radio buttons
    var thisClass;
    
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().append('<span class="na">NA</span>');

    if (fareClassMatch !== '') {
        thisClass = fareClassMatch;
    } else {
        var vals = tempFareData.split("_");


        if (mmbChangeFlightMode === true) {
            if (jQuery(".FlightAvailabilityTable").length > 1) {
                // enable this direction
                var thisDirection = vals[0] + "_" + vals[1] + "_";
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
            }
        } else {
            // enable this direction
            thisDirection = vals[0] + "_" + vals[1] + "_";
            //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").show();
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
        }

        // enable this class
        thisClass = "_" + vals[4];
    }
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").show();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().remove(".na");
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().show();

}


function SelectAvailabilityFare(selectedFareOption) {
    var fareData = null;
    var sFormData = "";
    var sPleaseWaitMessage = "";
    var InvalidSelectedFares = "";
    var oRegExp = new RegExp("'", "g");
    var bContinue = true;

    try {
        if (ClassBandMustMatch) {
            if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length === 1) {
                // get code
                var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").val();
                HideOrDisableUnwantedFares(tempFareData);
            } else if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 1) {
                // any radio buttons in jouneys > first, not in first's class, to be de-selected
                tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                var vals = tempFareData.split("_");
                var thisClass = vals[4];
                var changes = 0;

                jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var tFareData = jQuery(this).val();
                    vals = tFareData.split("_");
                    if (vals[4] !== thisClass) {
                        $(this).attr("checked", false);
                        changes++;
                    }
                });

                if (changes > 0) {
                    HideOrDisableUnwantedFares(tempFareData);
                }

            }
        }

        if ((jQuery("input:checked[id=RedeemAirMiles]").length === 1) || (jQuery("#chkAvailabilityFFRedeemAirMiles").length === 1)) {
            HideOrDisableExpensiveAirmiles();
        }


       
        var arfareData = [];
        if (UseTraditionalReturnFares) {
            var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
            var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;
            var bValidCombinableFaresSelected = false;

            if (iAvailabilityCount === 2) {
                bContinue = CheckValidReturnCombinableFares(selectedFareOption);
            }
            if ((!bContinue) || (iAvailabilityCount !== iSelectedAvailability)) {
                try { ShowCannedFaxInfo(); } catch (e) { var x = 1;}
                try { highlightSelected(); } catch (e) { var y = 1;}
                return false;
            }

            jQuery("input:checked[id^=optCalendarAvailabilityFare][type=radio]").each(function () {
                var tempFareData = jQuery(this).val();
                tempFareData = tempFareData.toString().replace(oRegExp, "\"");
                InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
                if (InvalidSelectedFares.length > 0) { tempFareData = tempFareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
                if (fareData !== null) {
                    fareData += ", ";
                } else {
                    fareData = "";
                }
                fareData += "'" + tempFareData + "'";
                arfareData.push(tempFareData);
            });
        } else {
            fareData = selectedFareOption.val();
            fareData = fareData.toString().replace(oRegExp, "\"");
            InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
            if (InvalidSelectedFares.length > 0) { fareData = fareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
            fareData = "'" + fareData + "'";
            arfareData.push(fareData);
        }

        try { ShowCannedFaxInfo(); } catch (e) { var x1 = 1;}
        try { highlightSelected(); } catch (e) { var x2 = 1;}

        //sFormData = "{ 'FormData': [" + fareData + "] }";
        var rq = new Object;
        rq.addFlightRequest = new Object;
        rq.addFlightRequest.VarsSessionID = $('#VarsSessionID').val();

        rq.addFlightRequest.fareData = arfareData;
        rq.addFlightRequest.Zone = "PUBLIC";

        try { sPleaseWaitMessage = CheckFlightsTranslations.AddingFlightToBasketMessage; } catch (e) { var x3 = 1; }
        var url = addFltUrl;
        if ( (new RegExp("/Agent/", "i")).test(window.location.href) ) {
            // agent page
            url = "../" + url;
            rq.addFlightRequest.Zone = "AGENT";
        }
        if ((new RegExp("/mmb/", "i")).test(window.location.href)  ){
            // mmb page
            url = "../" + url;
            rq.addFlightRequest.Zone = "MMB";
        }
        if ((new RegExp("/fqtv/", "i")).test(window.location.href)) {
            // mmb page
            url = "../" +url;
            rq.addFlightRequest.Zone = "FQTV";
        }

        SendAjaxRequest(url, $.toJSON(rq), null, AddFlightToBasket_onSuccess, AddFlightToBasket_onError, "", true, sPleaseWaitMessage);
    } catch (e) {
        var msg = e.message;
    }
}

function HideOrDisableExpensiveAirmiles() {
    // un-hide any hidden previously
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().show();

    // do hiding
    jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
        try {
            // get outstanding miles
            var selFare = jQuery(this).val();
            var selFareVals = selFare.split("_");
            var milesSpent = $.trim(jQuery(this).parent().text());
            var totalMilesAvailable = $.trim($(".milesTotal span").html()).replace(",", "");
            if (totalMilesAvailable !== "") {
                // logged in with miles to spend
                var milesLeft = parseInt(totalMilesAvailable, 10) - parseInt(milesSpent, 10)
                var otherDirection;
                if (selFareVals[1] === '0') {
                    otherDirection = selFareVals[0] + "_1_";
                } else {
                    otherDirection = selFareVals[0] + "_0_";
                }
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").length > 0) {
                    // remove value of existing fare this journey
                    milesLeft += parseInt(jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").val());
                }
                // hide if too expensive
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").each(function () {
                    var miles = parseInt($.trim($(this).parent().text()), 10);
                    if (miles > milesLeft) {
                        $(this).parent().children().hide();
                    }
                });
            }
        } catch (e) { var x = 1;}
    });
}


function ShowCannedFaxInfo() {
    if (onlyShowCannedFaxForSelectedFlight) {
        // hide all canned fax
        $(".InfoColumn").children().hide();
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).each(function () {
            $(this).next().children('.InfoColumn').children().show().removeClass("hidden");
        });
    }
}

function highlightSelected() {
    if (highlightSelectedFlight) {
        // hide all highlighting
        $(".AvailabilityRow, .AvailabilityTableFlightDivider, .AvailabilityTableConnectingFlightDivider, .AvailabilityTableCannedFactsDivider").removeClass('ui-state-highlight');
        $(".AvailabilityRow td, .AvailabilityTableFlightDivider td, .AvailabilityTableConnectingFlightDivider td, .AvailabilityTableCannedFactsDivider td").removeClass('ui-state-highlight');
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).addClass('ui-state-highlight');
        $(par).children("td").addClass('ui-state-highlight');
        $(par).each(function () {
            CheckHighlightNext(this);
            //if ($(this).hasClass("AvailabilityTableConnectingFlightDivider")) {
            //    $(this).next().addClass('ui-state-highlight');
            //}
        });
    }
}
function CheckHighlightNext(obj) {
    if ($(obj).hasClass("AvailabilityTableConnectingFlightDivider")) {
        $(obj).next().addClass('ui-state-highlight');
        // carry on loop! - careful
        CheckHighlightNext($(obj).next());
    }
}

function CheckValidReturnCombinableFares(selectedFareOption) {
    var fareData = null;
    var selectedFareTable = null;
    var bFareSelected = false;
    var bValidFare = false;
    var bInvalidFareSelected = false;
    var SelectedJourneyFareData = null;

    try {
        oPreviousFirstJourneyFareSelected = null;
        SelectedJourneyFareData = GetFareObjectData(selectedFareOption.get(0));
        var bIsCombinableFare = SelectedJourneyFareData.IsCombinableFareClass;
        var bHasReturnFare = SelectedJourneyFareData.FareClassHasReturnFare;
        if (oFirstJourneySelected === null) {
            oFirstJourneySelected = SelectedJourneyFareData.FlightAvailabilityTableClientID;
        } else {
            if (SelectedJourneyFareData.FlightAvailabilityTableClientID !== oFirstJourneySelected) return true;
        }

        jQuery("table[id^=tblFlightAvailability]").each(function () {
            var oTable = jQuery(this);
            if (oTable.attr("id") !== SelectedJourneyFareData.FlightAvailabilityTableClientID) { //selectedFareTable.attr("id")
                oTable.find("input[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var fareObject = jQuery(this).get(0);
                    var fareObjectData = GetFareObjectData(fareObject);

                    bFareSelected = fareObject.checked;
                    bValidFare = false;
                    if ((bIsCombinableFare) && (fareObjectData.IsCombinableFareClass)) {
                        bValidFare = true;
                    } else {
                        if ((bHasReturnFare) && ((new RegExp(SelectedJourneyFareData.SelectedFareClass, "i")).test(fareObjectData.SelectedFareClass))) {
                            var sReturnFareRoute = "";
                            if (SelectedJourneyFareData.FlightAvailabilityTableClientID === "tblFlightAvailability0_0_0") {
                                sReturnFareRoute = SelectedJourneyFareData.FareRoute + fareObjectData.FareRoute.substr(3);
                            } else {
                                sReturnFareRoute = fareObjectData.FareRoute + SelectedJourneyFareData.FareRoute.substr(3);
                            }

                            if ((new RegExp(sReturnFareRoute, "i")).test(SelectedJourneyFareData.ReturnFareRoutes)) {
                                bValidFare = true;
                            }
                        }
                    }

                    if (!bValidFare) {
                        if (!bInvalidFareSelected && bFareSelected) { bInvalidFareSelected = true; }
                        fareObject.checked = false;
                    }
                    fareObject.disabled = !bValidFare;
                });
            }
        });

        //return false;
        if (bInvalidFareSelected) {
            oPreviousFirstJourneyFareSelected = selectedFareOption;
            jQuery("#divEmptyShoppingBasket").unbind("click").click();
            return true;
        } else {
            return true;
        }
    } catch (e) { var x = 1;}
}

function GetFareObjectData(fareObject) {
    var fareObjectData = null;
    var oRegExp = new RegExp("'", "g");

    try {
        fareObjectData = jQuery.parseJSON(fareObject.value.toString().replace(oRegExp, "\""));
        var sID_Indices = fareObject.id.replace("optCalendarAvailabilityFare", "") + "_" + fareObjectData.JourneyIndex + "_" + fareObjectData.FlightLegIndex;
        var fareObjectDateField = jQuery("#hfldCalendarAvailabilityDepDateTime" + sID_Indices);
        fareObjectData.SelectedFareDate = Date.parse(fareObjectDateField.val());
        fareObjectData.FlightDuration = jQuery("#hfldCalendarAvailabilityDuration" + sID_Indices).val();
        fareObjectData.MinConnectionTime = jQuery("#hfldCalendarAvailabilityMinConnectionTime" + sID_Indices).val();
    } catch (e) {
        fareObjectData = new Object;

    }

    return fareObjectData;
}

function ValidateSelectedFlights() {
    try {
        var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
        var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;

        //        if (ShoppingBasket2.UseBasket2 == true) {
        if ((!ShoppingBasket2.IsBasketEmpty) && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount) {
            return true;
        }
        if (iSelectedAvailability === 0) {
            try { modalDialog(flightSelectPageTranslationsMsgs.FlightSelectionErrorMessage); } catch (e) {var x = 1;}
            return false;
        }
        if ((iAvailabilityCount > 1) && (iSelectedAvailability > 0) && (iSelectedAvailability !== iAvailabilityCount)) {
            try { modalDialog(flightSelectPageTranslationsMsgs.ReturnFlightSelectionErrorMessage); } catch (e) {                var x5 = 1;}
            return false;

        }

            return (!ShoppingBasket2.IsBasketEmpty && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount);
        //} else {
        //    return ((!oCurrentShoppingBasket.IsBasketEmpty) && (iSelectedAvailability > 0) && (iSelectedAvailability == iAvailabilityCount));
        //}
    } catch (e) {
        return false;
    }
}

function ToggleFlightAvailabilityAirMilesMode_onSuccess(msg) {
    try {
        if (msg.Data !== null && msg.Data.length > 0) {
            jQuery("div[id$=divFlightAvailabilityFound]").html(msg.Data);
            // InitialiseCheckFlightsObjects(null);
            RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
            InitAvailabilityDisplay();
        }
    } catch (e) {        var x = 1; }
}

function GetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
        $("#Destination").val(sDestinationCityCode);
    } catch (e) {        var x = 1; }

}

function InitRequirements() {

    $('.requirementsInnerContent').show();
    //KeepAlive();

    if (RequirementsDoOneShot === true) {
        SendAjaxRequest("../WebServices/Airports.asmx/OneShotLoad", "", "html", RequirementsOneShotLoad_onSuccess, null, "");
    }


    $(".requirementsLabel").unbind("click").click(function () {
    });

    $("#radio-jquery-ui").buttonset();

    try { InitialiseDatePicker(); } catch (e) {        var x = 1;}

    if (RequirementsEarliestBookingDate !== null) {
        jQuery("#departuredate, #returndate").datepicker("option", "minDate", RequirementsEarliestBookingDate);
    }

    if (RequirementsDefaultDepartureDate !== null && jQuery("#departuredate").datepicker("getDate") !== RequirementsDefaultDepartureDate) {
        jQuery("#departuredate").datepicker("setDate", RequirementsDefaultDepartureDate);
    }

    if (RequirementsDefaultReturnDate !== null && jQuery("input[name=ReturnTrip]:radio:checked").length === 1) {
        jQuery("#returndate").datepicker("setDate", RequirementsDefaultReturnDate);
    }

    jQuery("#departuredate").change(function () {
        var dSelectedDepartureDate = jQuery(this).datepicker("getDate");
        jQuery("#returndate").datepicker("option", "minDate", dSelectedDepartureDate);
        if (jQuery('input[name=ReturnTrip]:radio:checked').val() === 'chkJourneyTypeReturn' && jQuery("#returndate").val().length === 0) {
            jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate);
        }
        try { if (RequirementsProperties.AutoUpdateReturnDate !== null) { jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate.addDays(RequirementsProperties.AutoUpdateReturnDate)); } }
        catch (e) {
            var x = 1;
    }
    });

    jQuery("#NumberOfAdults").change(function () {
        var noAdultsSelected = parseInt(jQuery(this).val());

        if (noAdultsSelected < 0) { noAdultsSelected = 0; }
        if (jQuery("#NumberOfInfants").length > 0) {
            var fldInfants = jQuery("#NumberOfInfants");
            var noOptions = fldInfants.children().length;

            noAdultsSelected += 1;
            if (noOptions > noAdultsSelected) {
                fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
            } else {
                for (var i = noOptions; (i < noAdultsSelected && i <= RequirementsProperties.MaxInfants) ; i++) {
                    fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                }
            }
        }
    });

    $('#Origin').change(function () {
        SendAjaxRequest(DestCityUrl, "{'origin':'" + $('#Origin').val() + "'}", "html", RequirementsGetDestinations_onSuccess, null, "");
    });

    $('input[name=ReturnTrip]:radio').change(function () {
        if ($('input[name=ReturnTrip]:radio:checked').val() !== 'chkJourneyTypeReturn')
            $('.requirementsReturning').hide();
        else
            $('.requirementsReturning').show();
    });

    $('#submitButton').click(function (e) {

        var wsRq = BuildAvSearch(e);
        wsRq.SearchUser = "PUBLIC";
        if (wsRq !== false) {
            var sFormData = '{"FormData":' + $.toJSON(wsRq) + ',"IsMMBChangeFlightMode":false, "IsRefineSerach": false}';

            SendAjaxRequest(AvUrl, sFormData, null, RequirementsDoSubmit_onSuccess, RequirementsDoSubmit_onError, null, true, null);
        }
        return false;
    });
    // hover effects
    jQuery(".ui-button.ui-state-active").hover(
        function () { jQuery(this).removeClass("ui-state-active").addClass("ui-state-hover"); },
        function () { jQuery(this).removeClass("ui-state-hover").addClass("ui-state-active"); }
    ); //end hover
    InitChildCheck();
}

function InitChildCheck() {
    try {
        if (ChildNeedsAdult == true ) {
            // check on change no children
            $("#NumberOfChildren").unbind("change").change(function (e) {
                var noSelected = parseInt(jQuery(this).val());
                if (noSelected > 0) {
                    $("#Adults_0").wrap('<span/>');
                } else {
                    $("#Adults_0").unwrap();
                }
            });

            // check current settings
            DoChildCheck($("#NumberOfChildren"));
        }
    }
    catch (e) {
        
    }    
}
function DoChildCheck(obj) {
    var noSelected = parseInt(jQuery(obj).val());
    if (noSelected > 0) {
        $("#Adults_0").wrap('<span/>');
    
    }
}



//function GetHomeCity_onSuccess(msg) {

//    try {
//        sHomeCityCode = msg;
//    } catch (e) { }

//}

function GetOrigins_onSuccess(msg) {

    try {
        $("#Origin").html(msg);
        $("#Origin").val(sHomeCityCode);
        $("#Origin").change();
    } catch (e) {
        var x = 1;
    }

}

function RequirementsOneShotLoad_onSuccess(msg) {

    try {
        var o = jQuery.parseJSON(msg);

        sHomeCityCode = o.HomeCity;
        $("#Origin").html(o.OriginList);
        if (o.SelectedOriginCity.length > 0) {
            $("#Origin").val(o.SelectedOriginCity);
        } else {
            $("#Origin").val(sHomeCityCode);
        }
        $("#Destination").html(o.DestinationList);
        if (o.SelectedDestinationCity.length > 0) { $("#Destination").val(o.SelectedDestinationCity); }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsGetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onSuccess(msg) {

    try {
        if (msg.Result === 'OK') {
            if (msg.NextURL !== '') {
                switch ($('#formRequirements').attr('target')) {
                    case '_blank':
                        window.open(msg.NextURL);
                        break;
                    case '_top':
                    default:
                        // window.top.location = msg.NextURL; // +"?VarsSessionID=" + $("#VarsSessionID").val(); 
                        PostToPage(msg.NextURL);
                }
                try { ShowLoadingProgressDialog(RequirementsPageTranslations.LoadingFlightsMessage); } catch (e) { var xv = 1;}
            }
        } else {
            // ShowRequirementsModalDialog(msg.ErrorMsg);
            WsServerErrorDialog(msg);
        }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onError(errorText, msg) {

    try {
        var $p = $('<p class="RequirementsDialog"></p>').hide().appendTo("body");
        var dlgH = parseInt($p.css("height").replace("px", ""), 10);
        var dlgW = parseInt($p.css("width").replace("px", ""), 10);
        $p.remove();

        ShowModalDialog(errorText, "Search Error", dlgH, dlgW);

    } catch (e) {
        var x = 1;

    }

}

</script><script type="text/javascript">function InitBeautifulCheckbox() {
    $('.input-group-addon.cb-beautiful').each(function () {

        var $widget = $(this),
            $input = $widget.find('input'),
            type = $input.attr('type');
        settings = {
            checkbox: {
                on: { icon: 'fa fa-1-5x fa-check-square-o' },
                off: { icon: 'fa fa-1-5x fa-square-o' }
            },
            radio: {
                on: { icon: 'fa fa-dot-circle-o' },
                off: { icon: 'fa fa-circle-o' }
            }
        };
        if ($widget.find('span').length == 0) {
            $widget.prepend('<span class="' + settings[type].off.icon + '"></span>');
        }
        $widget.unbind("click").click(function () {
            $input.prop('checked', !$input.is(':checked'));
            $input.trigger("change");
            updateDisplay();
        });

        function updateDisplay() {
            var isChecked = $input.is(':checked') ? 'on' : 'off';

            $widget.find('.fa').attr('class', settings[type][isChecked].icon);

            //Just for desplay
            //isChecked = $input.is(':checked') ? 'checked' : 'not Checked';
            //$widget.closest('.input-group').find('input[type="text"]').val('Input is currently ' + isChecked)
        }

        updateDisplay();
    });
}

jQuery(document).ready(function () {
    InitBeautifulCheckbox();
});
</script><script type="text/javascript">/**
 * bootbox.js v4.4.0
 *
 * http://bootboxjs.com/license.txt
 */
!function (a, b) { "use strict"; "function" == typeof define && define.amd ? define(["jquery"], b) : "object" == typeof exports ? module.exports = b(require("jquery")) : a.bootbox = b(a.jQuery) }(this, function a(b, c) { "use strict"; function d(a) { var b = q[o.locale]; return b ? b[a] : q.en[a] } function e(a, c, d) { a.stopPropagation(), a.preventDefault(); var e = b.isFunction(d) && d.call(c, a) === !1; e || c.modal("hide") } function f(a) { var b, c = 0; for (b in a) c++; return c } function g(a, c) { var d = 0; b.each(a, function (a, b) { c(a, b, d++) }) } function h(a) { var c, d; if ("object" != typeof a) throw new Error("Please supply an object of options"); if (!a.message) throw new Error("Please specify a message"); return a = b.extend({}, o, a), a.buttons || (a.buttons = {}), c = a.buttons, d = f(c), g(c, function (a, e, f) { if (b.isFunction(e) && (e = c[a] = { callback: e }), "object" !== b.type(e)) throw new Error("button with key " + a + " must be an object"); e.label || (e.label = a), e.className || (e.className = 2 >= d && f === d - 1 ? "btn-primary" : "btn-default") }), a } function i(a, b) { var c = a.length, d = {}; if (1 > c || c > 2) throw new Error("Invalid argument length"); return 2 === c || "string" == typeof a[0] ? (d[b[0]] = a[0], d[b[1]] = a[1]) : d = a[0], d } function j(a, c, d) { return b.extend(!0, {}, a, i(c, d)) } function k(a, b, c, d) { var e = { className: "bootbox-" + a, buttons: l.apply(null, b) }; return m(j(e, d, c), b) } function l() { for (var a = {}, b = 0, c = arguments.length; c > b; b++) { var e = arguments[b], f = e.toLowerCase(), g = e.toUpperCase(); a[f] = { label: d(g) } } return a } function m(a, b) { var d = {}; return g(b, function (a, b) { d[b] = !0 }), g(a.buttons, function (a) { if (d[a] === c) throw new Error("button key " + a + " is not allowed (options are " + b.join("\n") + ")") }), a } var n = { dialog: "<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>", header: "<div class='modal-header modal-header-primary'><h4 class='modal-title'></h4></div>", footer: "<div class='modal-footer'></div>", closeButton: "<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>", form: "<form class='bootbox-form'></form>", inputs: { text: "<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />", textarea: "<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>", email: "<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />", select: "<select class='bootbox-input bootbox-input-select form-control'></select>", checkbox: "<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>", date: "<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />", time: "<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />", number: "<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />", password: "<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />" } }, o = { locale: "en", backdrop: "static", animate: !0, className: null, closeButton: !0, show: !0, container: "body" }, p = {}; p.alert = function () { var a; if (a = k("alert", ["ok"], ["message", "callback"], arguments), a.callback && !b.isFunction(a.callback)) throw new Error("alert requires callback property to be a function when provided"); return a.buttons.ok.callback = a.onEscape = function () { return b.isFunction(a.callback) ? a.callback.call(this) : !0 }, p.dialog(a) }, p.confirm = function () { var a; if (a = k("confirm", ["cancel", "confirm"], ["message", "callback"], arguments), a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, !1) }, a.buttons.confirm.callback = function () { return a.callback.call(this, !0) }, !b.isFunction(a.callback)) throw new Error("confirm requires a callback"); return p.dialog(a) }, p.prompt = function () { var a, d, e, f, h, i, k; if (f = b(n.form), d = { className: "bootbox-prompt", buttons: l("cancel", "confirm"), value: "", inputType: "text" }, a = m(j(d, arguments, ["title", "callback"]), ["cancel", "confirm"]), i = a.show === c ? !0 : a.show, a.message = f, a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, null) }, a.buttons.confirm.callback = function () { var c; switch (a.inputType) { case "text": case "textarea": case "email": case "select": case "date": case "time": case "number": case "password": c = h.val(); break; case "checkbox": var d = h.find("input:checked"); c = [], g(d, function (a, d) { c.push(b(d).val()) }) } return a.callback.call(this, c) }, a.show = !1, !a.title) throw new Error("prompt requires a title"); if (!b.isFunction(a.callback)) throw new Error("prompt requires a callback"); if (!n.inputs[a.inputType]) throw new Error("invalid prompt type"); switch (h = b(n.inputs[a.inputType]), a.inputType) { case "text": case "textarea": case "email": case "date": case "time": case "number": case "password": h.val(a.value); break; case "select": var o = {}; if (k = a.inputOptions || [], !b.isArray(k)) throw new Error("Please pass an array of input options"); if (!k.length) throw new Error("prompt with select requires options"); g(k, function (a, d) { var e = h; if (d.value === c || d.text === c) throw new Error("given options in wrong format"); d.group && (o[d.group] || (o[d.group] = b("<optgroup/>").attr("label", d.group)), e = o[d.group]), e.append("<option value='" + d.value + "'>" + d.text + "</option>") }), g(o, function (a, b) { h.append(b) }), h.val(a.value); break; case "checkbox": var q = b.isArray(a.value) ? a.value : [a.value]; if (k = a.inputOptions || [], !k.length) throw new Error("prompt with checkbox requires options"); if (!k[0].value || !k[0].text) throw new Error("given options in wrong format"); h = b("<div/>"), g(k, function (c, d) { var e = b(n.inputs[a.inputType]); e.find("input").attr("value", d.value), e.find("label").append(d.text), g(q, function (a, b) { b === d.value && e.find("input").prop("checked", !0) }), h.append(e) }) } return a.placeholder && h.attr("placeholder", a.placeholder), a.pattern && h.attr("pattern", a.pattern), a.maxlength && h.attr("maxlength", a.maxlength), f.append(h), f.on("submit", function (a) { a.preventDefault(), a.stopPropagation(), e.find(".btn-primary").click() }), e = p.dialog(a), e.off("shown.bs.modal"), e.on("shown.bs.modal", function () { h.focus() }), i === !0 && e.modal("show"), e }, p.dialog = function (a) { a = h(a); var d = b(n.dialog), f = d.find(".modal-dialog"), i = d.find(".modal-body"), j = a.buttons, k = "", l = { onEscape: a.onEscape }; if (b.fn.modal === c) throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details."); if (g(j, function (a, b) { k += "<button data-bb-handler='" + a + "' type='button' class='btn " + b.className + "'>" + b.label + "</button>", l[a] = b.callback }), i.find(".bootbox-body").html(a.message), a.animate === !0 && d.addClass("fade"), a.className && d.addClass(a.className), "large" === a.size ? f.addClass("modal-lg") : "small" === a.size && f.addClass("modal-sm"), a.title && i.before(n.header), a.closeButton) { var m = b(n.closeButton); a.title ? d.find(".modal-header").prepend(m) : m.css("margin-top", "-10px").prependTo(i) } return a.title && d.find(".modal-title").html(a.title), k.length && (i.after(n.footer), d.find(".modal-footer").html(k)), d.on("hidden.bs.modal", function (a) { a.target === this && d.remove() }), d.on("shown.bs.modal", function () { d.find(".btn-primary:first").focus() }), "static" !== a.backdrop && d.on("click.dismiss.bs.modal", function (a) { d.children(".modal-backdrop").length && (a.currentTarget = d.children(".modal-backdrop").get(0)), a.target === a.currentTarget && d.trigger("escape.close.bb") }), d.on("escape.close.bb", function (a) { l.onEscape && e(a, d, l.onEscape) }), d.on("click", ".modal-footer button", function (a) { var c = b(this).data("bb-handler"); e(a, d, l[c]) }), d.on("click", ".bootbox-close-button", function (a) { e(a, d, l.onEscape) }), d.on("keyup", function (a) { 27 === a.which && d.trigger("escape.close.bb") }), b(a.container).append(d), d.modal({ backdrop: a.backdrop ? "static" : !1, keyboard: !1, show: !1 }), a.show && d.modal("show"), d }, p.setDefaults = function () { var a = {}; 2 === arguments.length ? a[arguments[0]] = arguments[1] : a = arguments[0], b.extend(o, a) }, p.hideAll = function () { return b(".bootbox").modal("hide"), p }; var q = { br: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Sim" },  da: { OK: "OK", CANCEL: "Annuller", CONFIRM: "Accepter" }, de: { OK: "OK", CANCEL: "Abbrechen", CONFIRM: "Akzeptieren" },  en: { OK: "OK", CANCEL: "Cancel", CONFIRM: "OK" }, es: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Aceptar" }, et: { OK: "OK", CANCEL: "Katkesta", CONFIRM: "OK" }, fi: { OK: "OK", CANCEL: "Peruuta", CONFIRM: "OK" }, fr: { OK: "OK", CANCEL: "Annuler", CONFIRM: "D'accord" },  hr: { OK: "OK", CANCEL: "Odustani", CONFIRM: "Potvrdi" }, id: { OK: "OK", CANCEL: "Batal", CONFIRM: "OK" }, it: { OK: "OK", CANCEL: "Annulla", CONFIRM: "Conferma" },  nl: { OK: "OK", CANCEL: "Annuleren", CONFIRM: "Accepteren" }, no: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, pl: { OK: "OK", CANCEL: "Anuluj", CONFIRM: "PotwierdÅº" }, pt: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Confirmar" },  sq: { OK: "OK", CANCEL: "Anulo", CONFIRM: "Prano" }, sv: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, }; return p.addLocale = function (a, c) { return b.each(["OK", "CANCEL", "CONFIRM"], function (a, b) { if (!c[b]) throw new Error("Please supply a translation for '" + b + "'") }), q[a] = { OK: c.OK, CANCEL: c.CANCEL, CONFIRM: c.CONFIRM }, p }, p.removeLocale = function (a) { return delete q[a], p }, p.setLocale = function (a) { return p.setDefaults("locale", a) }, p.init = function (c) { return a(c || b) }, p });
</script><script type="text/javascript" src="../js/requirements.js"></script>
        <script type="text/javascript" src="../js/jquery/lobibox.js"></script>
        <script type="text/javascript" src="quickload.js"></script>

<div id="spinnerModal" class="modal fade" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog spinner">
<div class="modal-content">
<div class="modal-header modal-back modal-header-primary" style="padding-bottom: 5px;padding-top:5px; border-top-right-radius: 5px; border-top-left-radius: 5px;">
    <h3 id="myModalLabel" style="padding-top: 5px; padding-bottom: 5px; margin-top: 0px; margin-bottom: 0px;">Loading Flights...</h3></div>
<div class="modal-body"> 
<i class="fa fa-refresh fa-spin fa-2x"></i><span id="PleaseWaitSpan" style="padding-left:30px;">Please Wait</span>
</div>
</div> 
</div></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
     <script type="text/javascript">
                $(document).ready(function () {
                    $('.selectpicker').selectpicker();
                });
        </script>


<script type="text/javascript">//<![CDATA[

var ChildNeedsAdult = false; 
try {
UserCurrentLanguage = "";var onlyShowCannedFaxForSelectedFlight = false;
var highlightSelectedFlight = true;

 } catch (e) { }

//]]></script>
<script type="text/javascript">//<![CDATA[

try {
WantQuickPanels = true;
var routes = []; 
routes.push({org: 'LVI', dest: ["LUN|LUSAKA (LUN)"]  });
routes.push({org: 'LUN', dest: ["LVI|LIVINGSTONE (LVI)","MNS|MANSA (MNS)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'MNS', dest: ["LUN|LUSAKA (LUN)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'NLA', dest: ["LUN|LUSAKA (LUN)","MNS|MANSA (MNS)"]  });

var RequirementsPageTranslations = {"NoDepartureDateError" : "Please select a departure date.", "NoReturnDateError" : "Please select a return date.", "DateOrderError" : "Please select a return date after the departure date.", "LoadingFlightsMessage" : "Please wait <br />Loading flights...", "ErrorSelectingFlights" : "Error selecting flights", "MaxPassengersErrorMessage" : "The maximum number of passengers allowed in a booking is limited to ", "LargerGroupsErrorMessage" : "For larger groups, please call ..."};
RequirementsDefaultPleaseWaitMessage = "Please wait...";DefaultPleaseWaitMessage = "Please wait...";RequirementsIE6Error = "Your browser is not supported.<br /> Internet Explorer 7 is the minimum supported version. ";RequirementsDefaultErrorMessage = "An error has occurred, please contact customer services.";RequirementsCurrentLanguage = "";RequirementsDoOneShot =  false, UserCurrentLanguage = "";RequirementsEarliestBookingDate = new Date(2021, 5, 16, 0, 0, 0);RequirementsDefaultDepartureDate = new Date(0001, 0, 01, 0, 0, 0);RequirementsDefaultReturnDate = new Date(0001, 0, 01, 0, 0, 0);
RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": null, "RequirementsPage": "CustomerPanels/Requirements.aspx", "IsMultiCityBooking": false }; var SelectPaxMessage = "Please select who is travelling" ;ChildNeedsAdult = False; 
DatePickerOptions = { "ShowCalendarIcon" : true, "CalendarIconURL" : "/VARS/Public/themes/cal.bmp" }; oCurrentTheme =  { "SpinnerColour1" : "#2779aa", "SpinnerColour2" : "#e4f1fb", "SpinnerColour3" : "green", "SpinnerIcon" : 8 };  } catch (e) { }

//]]></script>
<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div></body>
<body id="requirementsBody">
    <form method="post" action="./requirementsBS.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTc0NjkwNzAxMQ9kFgYCAw9kFgICAw8WAh4HVmlzaWJsZWhkAgcPFgIeCWlubmVyaHRtbAUSTG9hZGluZyBGbGlnaHRzLi4uZAIJDxYCHwEFC1BsZWFzZSBXYWl0ZGQZ/b7Myfo68EjLFMQmusLLCN2XnYMWAT7MfzuXS6Miwg==">
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="DD9D2F9C">
</div>
    <input type="hidden" id="refreshed" value="no">
    <input type="hidden" id="VarsSessionID" name="VarsSessionID" value="b0a3e04b-f572-4f0c-9528-d1dc5d6949bd" class="">


    
        
        
    <div id="divRequirementsPanel" class="divRequirementsPanel form-body form-horizontal"><div class="panel panel-default">
<div class="panel-body">
<input type="hidden" id="rqtm" name="rqtm" value="637594472809126930" class="">
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Origin" id="Origin" class="form-control"><option value="LVI">LIVINGSTONE (LVI)</option><option value="LUN" selected="selected">LUSAKA (LUN)</option><option value="MNS">MANSA (MNS)</option><option value="NLA">NDOLA (NLA)</option>
</select></div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Destination" id="Destination" class="form-control"><option value="LUN">LUSAKA (LUN)</option></select></div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<div class="col-md-12">
<div class="btn-group btn-group-sm" data-toggle="buttons"><label class="btn btn-default btn-outline btn-rounded active"><input name="ReturnTrip" id="ReturnTrip1" type="radio" checked="checked" value="chkJourneyTypeReturn"><i class="fa fa-exchange"></i> Return</label><label class="btn btn-default btn-outline btn-rounded"><input name="ReturnTrip" id="ReturnTrip2" type="radio" value="chkJourneyTypeOneWay"><i class="fa fa-long-arrow-right"></i> One Way</label></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group ">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="departuredate" name="departuredate" value="16-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="returndate" name="returndate" value="20-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfAdults" id="NumberOfAdults" class="form-control paxSelectControl"><option selected="selected" id="Adults_1" value="1">1 Adults</option><option id="Adults_2" value="2">2 Adults</option><option id="Adults_3" value="3">3 Adults</option><option id="Adults_4" value="4">4 Adults</option><option id="Adults_5" value="5">5 Adults</option><option id="Adults_6" value="6">6 Adults</option><option id="Adults_7" value="7">7 Adults</option><option id="Adults_8" value="8">8 Adults</option><option id="Adults_9" value="9">9 Adults</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfChildren" id="NumberOfChildren" class="form-control paxSelectControl"><option selected="selected" id="Children_0" value="0">0 Children</option><option id="Children_1" value="1">1 Children</option><option id="Children_2" value="2">2 Children</option><option id="Children_3" value="3">3 Children</option><option id="Children_4" value="4">4 Children</option><option id="Children_5" value="5">5 Children</option><option id="Children_6" value="6">6 Children</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="input-group  input-group-sm">
<input class="form-control" type="text" id="EVoucher" placeholder="EVoucher" name="EVoucher"><span class="input-group-addon"><i class="fa fa-tag"></i></span></div>
</div>
</div>
</div>
<div class="panel-footer">
<div class="row">
<div class="col-md-12 text-center">
<div class="input-group  input-group-sm">
<button id="submitButton" class="btn btn-default btn-next" type="submit">Continue</button></div>
</div>
</div>
</div>
</div>
</div>
    <div id="GrandMasterDialog"></div>
    <div id="RequirementsLoadingProgressDialog"></div>
    </form>
       <div id="dialog-message" style="display: none;" title="Information">
        <p>
            <span id="msgSpan">Searching for flights</span>
            <br><br>
        </p>
            <div class="LoadingProgressImage"></div>
    </div>


    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-json/2.5.1/jquery.json.min.js"></script>
    <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script type="text/javascript">/*
    Flights.js
*/
var fareClassMatch = '';
var ClassBandMustMatch = false;
var UseTraditionalReturnFares = false;

var FlightSelectTranslations = null;
var RequirementsPageTranslations = null;
var divNextPreviousDayAvailability = null;
var mmbChangeFlightMode = '';
var oFirstJourneySelected = null;
var oPreviousFirstJourneyFareSelected = null;
var RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": false };
var FlightSelectNextPage = "BookingOptions.aspx";
var FlightSelectAirMilesValidated = false;
var sEVoucher = "";
var RequirementsEarliestBookingDate = null;
var sOriginCityCode = "";
var sDestinationCityCode = "";
var sHomeCityCode = "";
var sDepartureDate = "";
var sReturnDate = "";
var dDefaultDepartureDate = null;
var dDefaultReturnDate = null;
var RequirementsDefaultDepartureDate = null;
var RequirementsDefaultReturnDate = null;
var RequirementsDoOneShot = null;
var AvUrl = "../WebServices/AvailabilityWS.asmx/GetFlightAvailability";
var DestCityUrl = "../WebServices/Airports.asmx/DestinationCityList";
var addFltUrl = "WebServices/AvailabilityWS.asmx/AddFlightToBasket";
var changeDayUrl = "WebServices/AvailabilityWS.asmx/ChangeDay";

function InitAvailabilityDisplay() {
    try {
        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").parent().unbind("click").click(function () {
            //SelectAvailabilityFare(jQuery(this));
            var rb = $(this).find("input[id^=optCalendarAvailabilityFare][type=radio]");
            $(rb).prop('checked', true);
            SelectAvailabilityFare(jQuery(rb));
            //return false;
        });

        $("#radio-jquery-ui").buttonset();

        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").unbind("click").click(function () {
            //    SelectAvailabilityFare(jQuery(this));
            //  return false;
        });

        /*
        $(".refineSearchType").unbind("click").click(function () {
            var rb = $(this).find("input[id=ReturnTrip][type=radio]");
            $(rb).prop('checked', true);
           // return false;
        });
        */

        jQuery("div[id^=divFlightAvailabilityPreviousDay], div[id^=divFlightAvailabilityNextDay]").unbind("click").click(function () {
            NextDayPreviousDay_onClick(jQuery(this));
        });


        if (ClassBandMustMatch) {
            if (fareClassMatch !== '') {
                HideOrDisableUnwantedFares('');
            } else {
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 0) {
                    var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                    HideOrDisableUnwantedFares(tempFareData);
                }
            }
        }

        InitialiseRefineSearch(null);
        InitialiseGenericRefineSearch();
    } catch (e) { var xa = 1;}

}
function InitialiseGenericRefineSearch() {
    try {
        $('.dropdown-menu input, .dropdown-menu label, .dropdown-menu select').click(function (e) {
            e.stopPropagation();
        });
    } catch (e) { var xb = 1;}


    try {
        //if (jQuery("div[id$=RefineSearchWhoIsTravelling]").length == 1) {
        jQuery("#NumberOfAdults").change(function () {
            var noAdultsSelected = parseInt(jQuery(this).val());

            if (noAdultsSelected < 0) { noAdultsSelected = 0; }
            if (jQuery("#NumberOfInfants").length > 0) {
                var fldInfants = jQuery("#NumberOfInfants");
                var noOptions = fldInfants.children().length;

                noAdultsSelected += 1;
                if (noOptions > (noAdultsSelected)) {
                    fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
                } else {
                    for (var i = noOptions; ((i < noAdultsSelected) && (i <= RequirementsProperties.MaxInfants)) ; i++) {
                        fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                    }
                }
            }
        });
        //}
    } catch (e) { var xc = 1; }
}
function AddFlightToBasket_onSuccess(msg) {
    if ( msg !== null &&  msg.Data !== "" ) {
        $("#divBasket2").html(msg.Data);
        try { $("#divMiniBasket").html(msg.Data2); } catch (e) { var x4 = 1;}
        try { $("#BandText").html(msg.DialogCaption); } catch (e) { var x3 = 1; }
        try { InitBasket(); } catch (e) { var x = 1;}
        try { OnPageLoad(); } catch (e) { var x1 = 1; }
    }
   // RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
}

function AddFlightToBasket_onError(ErrorMsg) {

    var dlgMsg = new Object;
    dlgMsg.OkAction = "RefreshPage()";
    dlgMsg.html = ErrorMsg;

    modalDialog(dlgMsg);

        //var oButtons = { "Ok": function() {           
        //    // refresh page
        //    //window.location.reload(true);
        //    RefreshPage();
        //    jQuery(this).dialog("destroy");
        //    }
        //};
        //if (RequirementsPageTranslations != null) {
        //    ShowModalDialog(ErrorMsg, RequirementsPageTranslations.ErrorSelectingFlights, 0, 0, oButtons);
        //} else {
        //    ShowModalDialog(ErrorMsg, "Warning", 0, 0, oButtons);
        //}

}

function HideOrDisableUnwantedFares(tempFareData) {
    // disable radio buttons
    var thisClass;
    
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().append('<span class="na">NA</span>');

    if (fareClassMatch !== '') {
        thisClass = fareClassMatch;
    } else {
        var vals = tempFareData.split("_");


        if (mmbChangeFlightMode === true) {
            if (jQuery(".FlightAvailabilityTable").length > 1) {
                // enable this direction
                var thisDirection = vals[0] + "_" + vals[1] + "_";
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
            }
        } else {
            // enable this direction
            thisDirection = vals[0] + "_" + vals[1] + "_";
            //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").show();
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
        }

        // enable this class
        thisClass = "_" + vals[4];
    }
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").show();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().remove(".na");
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().show();

}


function SelectAvailabilityFare(selectedFareOption) {
    var fareData = null;
    var sFormData = "";
    var sPleaseWaitMessage = "";
    var InvalidSelectedFares = "";
    var oRegExp = new RegExp("'", "g");
    var bContinue = true;

    try {
        if (ClassBandMustMatch) {
            if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length === 1) {
                // get code
                var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").val();
                HideOrDisableUnwantedFares(tempFareData);
            } else if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 1) {
                // any radio buttons in jouneys > first, not in first's class, to be de-selected
                tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                var vals = tempFareData.split("_");
                var thisClass = vals[4];
                var changes = 0;

                jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var tFareData = jQuery(this).val();
                    vals = tFareData.split("_");
                    if (vals[4] !== thisClass) {
                        $(this).attr("checked", false);
                        changes++;
                    }
                });

                if (changes > 0) {
                    HideOrDisableUnwantedFares(tempFareData);
                }

            }
        }

        if ((jQuery("input:checked[id=RedeemAirMiles]").length === 1) || (jQuery("#chkAvailabilityFFRedeemAirMiles").length === 1)) {
            HideOrDisableExpensiveAirmiles();
        }


       
        var arfareData = [];
        if (UseTraditionalReturnFares) {
            var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
            var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;
            var bValidCombinableFaresSelected = false;

            if (iAvailabilityCount === 2) {
                bContinue = CheckValidReturnCombinableFares(selectedFareOption);
            }
            if ((!bContinue) || (iAvailabilityCount !== iSelectedAvailability)) {
                try { ShowCannedFaxInfo(); } catch (e) { var x = 1;}
                try { highlightSelected(); } catch (e) { var y = 1;}
                return false;
            }

            jQuery("input:checked[id^=optCalendarAvailabilityFare][type=radio]").each(function () {
                var tempFareData = jQuery(this).val();
                tempFareData = tempFareData.toString().replace(oRegExp, "\"");
                InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
                if (InvalidSelectedFares.length > 0) { tempFareData = tempFareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
                if (fareData !== null) {
                    fareData += ", ";
                } else {
                    fareData = "";
                }
                fareData += "'" + tempFareData + "'";
                arfareData.push(tempFareData);
            });
        } else {
            fareData = selectedFareOption.val();
            fareData = fareData.toString().replace(oRegExp, "\"");
            InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
            if (InvalidSelectedFares.length > 0) { fareData = fareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
            fareData = "'" + fareData + "'";
            arfareData.push(fareData);
        }

        try { ShowCannedFaxInfo(); } catch (e) { var x1 = 1;}
        try { highlightSelected(); } catch (e) { var x2 = 1;}

        //sFormData = "{ 'FormData': [" + fareData + "] }";
        var rq = new Object;
        rq.addFlightRequest = new Object;
        rq.addFlightRequest.VarsSessionID = $('#VarsSessionID').val();

        rq.addFlightRequest.fareData = arfareData;
        rq.addFlightRequest.Zone = "PUBLIC";

        try { sPleaseWaitMessage = CheckFlightsTranslations.AddingFlightToBasketMessage; } catch (e) { var x3 = 1; }
        var url = addFltUrl;
        if ( (new RegExp("/Agent/", "i")).test(window.location.href) ) {
            // agent page
            url = "../" + url;
            rq.addFlightRequest.Zone = "AGENT";
        }
        if ((new RegExp("/mmb/", "i")).test(window.location.href)  ){
            // mmb page
            url = "../" + url;
            rq.addFlightRequest.Zone = "MMB";
        }
        if ((new RegExp("/fqtv/", "i")).test(window.location.href)) {
            // mmb page
            url = "../" +url;
            rq.addFlightRequest.Zone = "FQTV";
        }

        SendAjaxRequest(url, $.toJSON(rq), null, AddFlightToBasket_onSuccess, AddFlightToBasket_onError, "", true, sPleaseWaitMessage);
    } catch (e) {
        var msg = e.message;
    }
}

function HideOrDisableExpensiveAirmiles() {
    // un-hide any hidden previously
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().show();

    // do hiding
    jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
        try {
            // get outstanding miles
            var selFare = jQuery(this).val();
            var selFareVals = selFare.split("_");
            var milesSpent = $.trim(jQuery(this).parent().text());
            var totalMilesAvailable = $.trim($(".milesTotal span").html()).replace(",", "");
            if (totalMilesAvailable !== "") {
                // logged in with miles to spend
                var milesLeft = parseInt(totalMilesAvailable, 10) - parseInt(milesSpent, 10)
                var otherDirection;
                if (selFareVals[1] === '0') {
                    otherDirection = selFareVals[0] + "_1_";
                } else {
                    otherDirection = selFareVals[0] + "_0_";
                }
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").length > 0) {
                    // remove value of existing fare this journey
                    milesLeft += parseInt(jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").val());
                }
                // hide if too expensive
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").each(function () {
                    var miles = parseInt($.trim($(this).parent().text()), 10);
                    if (miles > milesLeft) {
                        $(this).parent().children().hide();
                    }
                });
            }
        } catch (e) { var x = 1;}
    });
}


function ShowCannedFaxInfo() {
    if (onlyShowCannedFaxForSelectedFlight) {
        // hide all canned fax
        $(".InfoColumn").children().hide();
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).each(function () {
            $(this).next().children('.InfoColumn').children().show().removeClass("hidden");
        });
    }
}

function highlightSelected() {
    if (highlightSelectedFlight) {
        // hide all highlighting
        $(".AvailabilityRow, .AvailabilityTableFlightDivider, .AvailabilityTableConnectingFlightDivider, .AvailabilityTableCannedFactsDivider").removeClass('ui-state-highlight');
        $(".AvailabilityRow td, .AvailabilityTableFlightDivider td, .AvailabilityTableConnectingFlightDivider td, .AvailabilityTableCannedFactsDivider td").removeClass('ui-state-highlight');
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).addClass('ui-state-highlight');
        $(par).children("td").addClass('ui-state-highlight');
        $(par).each(function () {
            CheckHighlightNext(this);
            //if ($(this).hasClass("AvailabilityTableConnectingFlightDivider")) {
            //    $(this).next().addClass('ui-state-highlight');
            //}
        });
    }
}
function CheckHighlightNext(obj) {
    if ($(obj).hasClass("AvailabilityTableConnectingFlightDivider")) {
        $(obj).next().addClass('ui-state-highlight');
        // carry on loop! - careful
        CheckHighlightNext($(obj).next());
    }
}

function CheckValidReturnCombinableFares(selectedFareOption) {
    var fareData = null;
    var selectedFareTable = null;
    var bFareSelected = false;
    var bValidFare = false;
    var bInvalidFareSelected = false;
    var SelectedJourneyFareData = null;

    try {
        oPreviousFirstJourneyFareSelected = null;
        SelectedJourneyFareData = GetFareObjectData(selectedFareOption.get(0));
        var bIsCombinableFare = SelectedJourneyFareData.IsCombinableFareClass;
        var bHasReturnFare = SelectedJourneyFareData.FareClassHasReturnFare;
        if (oFirstJourneySelected === null) {
            oFirstJourneySelected = SelectedJourneyFareData.FlightAvailabilityTableClientID;
        } else {
            if (SelectedJourneyFareData.FlightAvailabilityTableClientID !== oFirstJourneySelected) return true;
        }

        jQuery("table[id^=tblFlightAvailability]").each(function () {
            var oTable = jQuery(this);
            if (oTable.attr("id") !== SelectedJourneyFareData.FlightAvailabilityTableClientID) { //selectedFareTable.attr("id")
                oTable.find("input[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var fareObject = jQuery(this).get(0);
                    var fareObjectData = GetFareObjectData(fareObject);

                    bFareSelected = fareObject.checked;
                    bValidFare = false;
                    if ((bIsCombinableFare) && (fareObjectData.IsCombinableFareClass)) {
                        bValidFare = true;
                    } else {
                        if ((bHasReturnFare) && ((new RegExp(SelectedJourneyFareData.SelectedFareClass, "i")).test(fareObjectData.SelectedFareClass))) {
                            var sReturnFareRoute = "";
                            if (SelectedJourneyFareData.FlightAvailabilityTableClientID === "tblFlightAvailability0_0_0") {
                                sReturnFareRoute = SelectedJourneyFareData.FareRoute + fareObjectData.FareRoute.substr(3);
                            } else {
                                sReturnFareRoute = fareObjectData.FareRoute + SelectedJourneyFareData.FareRoute.substr(3);
                            }

                            if ((new RegExp(sReturnFareRoute, "i")).test(SelectedJourneyFareData.ReturnFareRoutes)) {
                                bValidFare = true;
                            }
                        }
                    }

                    if (!bValidFare) {
                        if (!bInvalidFareSelected && bFareSelected) { bInvalidFareSelected = true; }
                        fareObject.checked = false;
                    }
                    fareObject.disabled = !bValidFare;
                });
            }
        });

        //return false;
        if (bInvalidFareSelected) {
            oPreviousFirstJourneyFareSelected = selectedFareOption;
            jQuery("#divEmptyShoppingBasket").unbind("click").click();
            return true;
        } else {
            return true;
        }
    } catch (e) { var x = 1;}
}

function GetFareObjectData(fareObject) {
    var fareObjectData = null;
    var oRegExp = new RegExp("'", "g");

    try {
        fareObjectData = jQuery.parseJSON(fareObject.value.toString().replace(oRegExp, "\""));
        var sID_Indices = fareObject.id.replace("optCalendarAvailabilityFare", "") + "_" + fareObjectData.JourneyIndex + "_" + fareObjectData.FlightLegIndex;
        var fareObjectDateField = jQuery("#hfldCalendarAvailabilityDepDateTime" + sID_Indices);
        fareObjectData.SelectedFareDate = Date.parse(fareObjectDateField.val());
        fareObjectData.FlightDuration = jQuery("#hfldCalendarAvailabilityDuration" + sID_Indices).val();
        fareObjectData.MinConnectionTime = jQuery("#hfldCalendarAvailabilityMinConnectionTime" + sID_Indices).val();
    } catch (e) {
        fareObjectData = new Object;

    }

    return fareObjectData;
}

function ValidateSelectedFlights() {
    try {
        var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
        var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;

        //        if (ShoppingBasket2.UseBasket2 == true) {
        if ((!ShoppingBasket2.IsBasketEmpty) && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount) {
            return true;
        }
        if (iSelectedAvailability === 0) {
            try { modalDialog(flightSelectPageTranslationsMsgs.FlightSelectionErrorMessage); } catch (e) {var x = 1;}
            return false;
        }
        if ((iAvailabilityCount > 1) && (iSelectedAvailability > 0) && (iSelectedAvailability !== iAvailabilityCount)) {
            try { modalDialog(flightSelectPageTranslationsMsgs.ReturnFlightSelectionErrorMessage); } catch (e) {                var x5 = 1;}
            return false;

        }

            return (!ShoppingBasket2.IsBasketEmpty && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount);
        //} else {
        //    return ((!oCurrentShoppingBasket.IsBasketEmpty) && (iSelectedAvailability > 0) && (iSelectedAvailability == iAvailabilityCount));
        //}
    } catch (e) {
        return false;
    }
}

function ToggleFlightAvailabilityAirMilesMode_onSuccess(msg) {
    try {
        if (msg.Data !== null && msg.Data.length > 0) {
            jQuery("div[id$=divFlightAvailabilityFound]").html(msg.Data);
            // InitialiseCheckFlightsObjects(null);
            RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
            InitAvailabilityDisplay();
        }
    } catch (e) {        var x = 1; }
}

function GetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
        $("#Destination").val(sDestinationCityCode);
    } catch (e) {        var x = 1; }

}

function InitRequirements() {

    $('.requirementsInnerContent').show();
    //KeepAlive();

    if (RequirementsDoOneShot === true) {
        SendAjaxRequest("../WebServices/Airports.asmx/OneShotLoad", "", "html", RequirementsOneShotLoad_onSuccess, null, "");
    }


    $(".requirementsLabel").unbind("click").click(function () {
    });

    $("#radio-jquery-ui").buttonset();

    try { InitialiseDatePicker(); } catch (e) {        var x = 1;}

    if (RequirementsEarliestBookingDate !== null) {
        jQuery("#departuredate, #returndate").datepicker("option", "minDate", RequirementsEarliestBookingDate);
    }

    if (RequirementsDefaultDepartureDate !== null && jQuery("#departuredate").datepicker("getDate") !== RequirementsDefaultDepartureDate) {
        jQuery("#departuredate").datepicker("setDate", RequirementsDefaultDepartureDate);
    }

    if (RequirementsDefaultReturnDate !== null && jQuery("input[name=ReturnTrip]:radio:checked").length === 1) {
        jQuery("#returndate").datepicker("setDate", RequirementsDefaultReturnDate);
    }

    jQuery("#departuredate").change(function () {
        var dSelectedDepartureDate = jQuery(this).datepicker("getDate");
        jQuery("#returndate").datepicker("option", "minDate", dSelectedDepartureDate);
        if (jQuery('input[name=ReturnTrip]:radio:checked').val() === 'chkJourneyTypeReturn' && jQuery("#returndate").val().length === 0) {
            jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate);
        }
        try { if (RequirementsProperties.AutoUpdateReturnDate !== null) { jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate.addDays(RequirementsProperties.AutoUpdateReturnDate)); } }
        catch (e) {
            var x = 1;
    }
    });

    jQuery("#NumberOfAdults").change(function () {
        var noAdultsSelected = parseInt(jQuery(this).val());

        if (noAdultsSelected < 0) { noAdultsSelected = 0; }
        if (jQuery("#NumberOfInfants").length > 0) {
            var fldInfants = jQuery("#NumberOfInfants");
            var noOptions = fldInfants.children().length;

            noAdultsSelected += 1;
            if (noOptions > noAdultsSelected) {
                fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
            } else {
                for (var i = noOptions; (i < noAdultsSelected && i <= RequirementsProperties.MaxInfants) ; i++) {
                    fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                }
            }
        }
    });

    $('#Origin').change(function () {
        SendAjaxRequest(DestCityUrl, "{'origin':'" + $('#Origin').val() + "'}", "html", RequirementsGetDestinations_onSuccess, null, "");
    });

    $('input[name=ReturnTrip]:radio').change(function () {
        if ($('input[name=ReturnTrip]:radio:checked').val() !== 'chkJourneyTypeReturn')
            $('.requirementsReturning').hide();
        else
            $('.requirementsReturning').show();
    });

    $('#submitButton').click(function (e) {

        var wsRq = BuildAvSearch(e);
        wsRq.SearchUser = "PUBLIC";
        if (wsRq !== false) {
            var sFormData = '{"FormData":' + $.toJSON(wsRq) + ',"IsMMBChangeFlightMode":false, "IsRefineSerach": false}';

            SendAjaxRequest(AvUrl, sFormData, null, RequirementsDoSubmit_onSuccess, RequirementsDoSubmit_onError, null, true, null);
        }
        return false;
    });
    // hover effects
    jQuery(".ui-button.ui-state-active").hover(
        function () { jQuery(this).removeClass("ui-state-active").addClass("ui-state-hover"); },
        function () { jQuery(this).removeClass("ui-state-hover").addClass("ui-state-active"); }
    ); //end hover
    InitChildCheck();
}

function InitChildCheck() {
    try {
        if (ChildNeedsAdult == true ) {
            // check on change no children
            $("#NumberOfChildren").unbind("change").change(function (e) {
                var noSelected = parseInt(jQuery(this).val());
                if (noSelected > 0) {
                    $("#Adults_0").wrap('<span/>');
                } else {
                    $("#Adults_0").unwrap();
                }
            });

            // check current settings
            DoChildCheck($("#NumberOfChildren"));
        }
    }
    catch (e) {
        
    }    
}
function DoChildCheck(obj) {
    var noSelected = parseInt(jQuery(obj).val());
    if (noSelected > 0) {
        $("#Adults_0").wrap('<span/>');
    
    }
}



//function GetHomeCity_onSuccess(msg) {

//    try {
//        sHomeCityCode = msg;
//    } catch (e) { }

//}

function GetOrigins_onSuccess(msg) {

    try {
        $("#Origin").html(msg);
        $("#Origin").val(sHomeCityCode);
        $("#Origin").change();
    } catch (e) {
        var x = 1;
    }

}

function RequirementsOneShotLoad_onSuccess(msg) {

    try {
        var o = jQuery.parseJSON(msg);

        sHomeCityCode = o.HomeCity;
        $("#Origin").html(o.OriginList);
        if (o.SelectedOriginCity.length > 0) {
            $("#Origin").val(o.SelectedOriginCity);
        } else {
            $("#Origin").val(sHomeCityCode);
        }
        $("#Destination").html(o.DestinationList);
        if (o.SelectedDestinationCity.length > 0) { $("#Destination").val(o.SelectedDestinationCity); }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsGetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onSuccess(msg) {

    try {
        if (msg.Result === 'OK') {
            if (msg.NextURL !== '') {
                switch ($('#formRequirements').attr('target')) {
                    case '_blank':
                        window.open(msg.NextURL);
                        break;
                    case '_top':
                    default:
                        // window.top.location = msg.NextURL; // +"?VarsSessionID=" + $("#VarsSessionID").val(); 
                        PostToPage(msg.NextURL);
                }
                try { ShowLoadingProgressDialog(RequirementsPageTranslations.LoadingFlightsMessage); } catch (e) { var xv = 1;}
            }
        } else {
            // ShowRequirementsModalDialog(msg.ErrorMsg);
            WsServerErrorDialog(msg);
        }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onError(errorText, msg) {

    try {
        var $p = $('<p class="RequirementsDialog"></p>').hide().appendTo("body");
        var dlgH = parseInt($p.css("height").replace("px", ""), 10);
        var dlgW = parseInt($p.css("width").replace("px", ""), 10);
        $p.remove();

        ShowModalDialog(errorText, "Search Error", dlgH, dlgW);

    } catch (e) {
        var x = 1;

    }

}

</script><script type="text/javascript">function InitBeautifulCheckbox() {
    $('.input-group-addon.cb-beautiful').each(function () {

        var $widget = $(this),
            $input = $widget.find('input'),
            type = $input.attr('type');
        settings = {
            checkbox: {
                on: { icon: 'fa fa-1-5x fa-check-square-o' },
                off: { icon: 'fa fa-1-5x fa-square-o' }
            },
            radio: {
                on: { icon: 'fa fa-dot-circle-o' },
                off: { icon: 'fa fa-circle-o' }
            }
        };
        if ($widget.find('span').length == 0) {
            $widget.prepend('<span class="' + settings[type].off.icon + '"></span>');
        }
        $widget.unbind("click").click(function () {
            $input.prop('checked', !$input.is(':checked'));
            $input.trigger("change");
            updateDisplay();
        });

        function updateDisplay() {
            var isChecked = $input.is(':checked') ? 'on' : 'off';

            $widget.find('.fa').attr('class', settings[type][isChecked].icon);

            //Just for desplay
            //isChecked = $input.is(':checked') ? 'checked' : 'not Checked';
            //$widget.closest('.input-group').find('input[type="text"]').val('Input is currently ' + isChecked)
        }

        updateDisplay();
    });
}

jQuery(document).ready(function () {
    InitBeautifulCheckbox();
});
</script><script type="text/javascript">/**
 * bootbox.js v4.4.0
 *
 * http://bootboxjs.com/license.txt
 */
!function (a, b) { "use strict"; "function" == typeof define && define.amd ? define(["jquery"], b) : "object" == typeof exports ? module.exports = b(require("jquery")) : a.bootbox = b(a.jQuery) }(this, function a(b, c) { "use strict"; function d(a) { var b = q[o.locale]; return b ? b[a] : q.en[a] } function e(a, c, d) { a.stopPropagation(), a.preventDefault(); var e = b.isFunction(d) && d.call(c, a) === !1; e || c.modal("hide") } function f(a) { var b, c = 0; for (b in a) c++; return c } function g(a, c) { var d = 0; b.each(a, function (a, b) { c(a, b, d++) }) } function h(a) { var c, d; if ("object" != typeof a) throw new Error("Please supply an object of options"); if (!a.message) throw new Error("Please specify a message"); return a = b.extend({}, o, a), a.buttons || (a.buttons = {}), c = a.buttons, d = f(c), g(c, function (a, e, f) { if (b.isFunction(e) && (e = c[a] = { callback: e }), "object" !== b.type(e)) throw new Error("button with key " + a + " must be an object"); e.label || (e.label = a), e.className || (e.className = 2 >= d && f === d - 1 ? "btn-primary" : "btn-default") }), a } function i(a, b) { var c = a.length, d = {}; if (1 > c || c > 2) throw new Error("Invalid argument length"); return 2 === c || "string" == typeof a[0] ? (d[b[0]] = a[0], d[b[1]] = a[1]) : d = a[0], d } function j(a, c, d) { return b.extend(!0, {}, a, i(c, d)) } function k(a, b, c, d) { var e = { className: "bootbox-" + a, buttons: l.apply(null, b) }; return m(j(e, d, c), b) } function l() { for (var a = {}, b = 0, c = arguments.length; c > b; b++) { var e = arguments[b], f = e.toLowerCase(), g = e.toUpperCase(); a[f] = { label: d(g) } } return a } function m(a, b) { var d = {}; return g(b, function (a, b) { d[b] = !0 }), g(a.buttons, function (a) { if (d[a] === c) throw new Error("button key " + a + " is not allowed (options are " + b.join("\n") + ")") }), a } var n = { dialog: "<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>", header: "<div class='modal-header modal-header-primary'><h4 class='modal-title'></h4></div>", footer: "<div class='modal-footer'></div>", closeButton: "<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>", form: "<form class='bootbox-form'></form>", inputs: { text: "<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />", textarea: "<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>", email: "<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />", select: "<select class='bootbox-input bootbox-input-select form-control'></select>", checkbox: "<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>", date: "<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />", time: "<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />", number: "<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />", password: "<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />" } }, o = { locale: "en", backdrop: "static", animate: !0, className: null, closeButton: !0, show: !0, container: "body" }, p = {}; p.alert = function () { var a; if (a = k("alert", ["ok"], ["message", "callback"], arguments), a.callback && !b.isFunction(a.callback)) throw new Error("alert requires callback property to be a function when provided"); return a.buttons.ok.callback = a.onEscape = function () { return b.isFunction(a.callback) ? a.callback.call(this) : !0 }, p.dialog(a) }, p.confirm = function () { var a; if (a = k("confirm", ["cancel", "confirm"], ["message", "callback"], arguments), a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, !1) }, a.buttons.confirm.callback = function () { return a.callback.call(this, !0) }, !b.isFunction(a.callback)) throw new Error("confirm requires a callback"); return p.dialog(a) }, p.prompt = function () { var a, d, e, f, h, i, k; if (f = b(n.form), d = { className: "bootbox-prompt", buttons: l("cancel", "confirm"), value: "", inputType: "text" }, a = m(j(d, arguments, ["title", "callback"]), ["cancel", "confirm"]), i = a.show === c ? !0 : a.show, a.message = f, a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, null) }, a.buttons.confirm.callback = function () { var c; switch (a.inputType) { case "text": case "textarea": case "email": case "select": case "date": case "time": case "number": case "password": c = h.val(); break; case "checkbox": var d = h.find("input:checked"); c = [], g(d, function (a, d) { c.push(b(d).val()) }) } return a.callback.call(this, c) }, a.show = !1, !a.title) throw new Error("prompt requires a title"); if (!b.isFunction(a.callback)) throw new Error("prompt requires a callback"); if (!n.inputs[a.inputType]) throw new Error("invalid prompt type"); switch (h = b(n.inputs[a.inputType]), a.inputType) { case "text": case "textarea": case "email": case "date": case "time": case "number": case "password": h.val(a.value); break; case "select": var o = {}; if (k = a.inputOptions || [], !b.isArray(k)) throw new Error("Please pass an array of input options"); if (!k.length) throw new Error("prompt with select requires options"); g(k, function (a, d) { var e = h; if (d.value === c || d.text === c) throw new Error("given options in wrong format"); d.group && (o[d.group] || (o[d.group] = b("<optgroup/>").attr("label", d.group)), e = o[d.group]), e.append("<option value='" + d.value + "'>" + d.text + "</option>") }), g(o, function (a, b) { h.append(b) }), h.val(a.value); break; case "checkbox": var q = b.isArray(a.value) ? a.value : [a.value]; if (k = a.inputOptions || [], !k.length) throw new Error("prompt with checkbox requires options"); if (!k[0].value || !k[0].text) throw new Error("given options in wrong format"); h = b("<div/>"), g(k, function (c, d) { var e = b(n.inputs[a.inputType]); e.find("input").attr("value", d.value), e.find("label").append(d.text), g(q, function (a, b) { b === d.value && e.find("input").prop("checked", !0) }), h.append(e) }) } return a.placeholder && h.attr("placeholder", a.placeholder), a.pattern && h.attr("pattern", a.pattern), a.maxlength && h.attr("maxlength", a.maxlength), f.append(h), f.on("submit", function (a) { a.preventDefault(), a.stopPropagation(), e.find(".btn-primary").click() }), e = p.dialog(a), e.off("shown.bs.modal"), e.on("shown.bs.modal", function () { h.focus() }), i === !0 && e.modal("show"), e }, p.dialog = function (a) { a = h(a); var d = b(n.dialog), f = d.find(".modal-dialog"), i = d.find(".modal-body"), j = a.buttons, k = "", l = { onEscape: a.onEscape }; if (b.fn.modal === c) throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details."); if (g(j, function (a, b) { k += "<button data-bb-handler='" + a + "' type='button' class='btn " + b.className + "'>" + b.label + "</button>", l[a] = b.callback }), i.find(".bootbox-body").html(a.message), a.animate === !0 && d.addClass("fade"), a.className && d.addClass(a.className), "large" === a.size ? f.addClass("modal-lg") : "small" === a.size && f.addClass("modal-sm"), a.title && i.before(n.header), a.closeButton) { var m = b(n.closeButton); a.title ? d.find(".modal-header").prepend(m) : m.css("margin-top", "-10px").prependTo(i) } return a.title && d.find(".modal-title").html(a.title), k.length && (i.after(n.footer), d.find(".modal-footer").html(k)), d.on("hidden.bs.modal", function (a) { a.target === this && d.remove() }), d.on("shown.bs.modal", function () { d.find(".btn-primary:first").focus() }), "static" !== a.backdrop && d.on("click.dismiss.bs.modal", function (a) { d.children(".modal-backdrop").length && (a.currentTarget = d.children(".modal-backdrop").get(0)), a.target === a.currentTarget && d.trigger("escape.close.bb") }), d.on("escape.close.bb", function (a) { l.onEscape && e(a, d, l.onEscape) }), d.on("click", ".modal-footer button", function (a) { var c = b(this).data("bb-handler"); e(a, d, l[c]) }), d.on("click", ".bootbox-close-button", function (a) { e(a, d, l.onEscape) }), d.on("keyup", function (a) { 27 === a.which && d.trigger("escape.close.bb") }), b(a.container).append(d), d.modal({ backdrop: a.backdrop ? "static" : !1, keyboard: !1, show: !1 }), a.show && d.modal("show"), d }, p.setDefaults = function () { var a = {}; 2 === arguments.length ? a[arguments[0]] = arguments[1] : a = arguments[0], b.extend(o, a) }, p.hideAll = function () { return b(".bootbox").modal("hide"), p }; var q = { br: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Sim" },  da: { OK: "OK", CANCEL: "Annuller", CONFIRM: "Accepter" }, de: { OK: "OK", CANCEL: "Abbrechen", CONFIRM: "Akzeptieren" },  en: { OK: "OK", CANCEL: "Cancel", CONFIRM: "OK" }, es: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Aceptar" }, et: { OK: "OK", CANCEL: "Katkesta", CONFIRM: "OK" }, fi: { OK: "OK", CANCEL: "Peruuta", CONFIRM: "OK" }, fr: { OK: "OK", CANCEL: "Annuler", CONFIRM: "D'accord" },  hr: { OK: "OK", CANCEL: "Odustani", CONFIRM: "Potvrdi" }, id: { OK: "OK", CANCEL: "Batal", CONFIRM: "OK" }, it: { OK: "OK", CANCEL: "Annulla", CONFIRM: "Conferma" },  nl: { OK: "OK", CANCEL: "Annuleren", CONFIRM: "Accepteren" }, no: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, pl: { OK: "OK", CANCEL: "Anuluj", CONFIRM: "PotwierdÅº" }, pt: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Confirmar" },  sq: { OK: "OK", CANCEL: "Anulo", CONFIRM: "Prano" }, sv: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, }; return p.addLocale = function (a, c) { return b.each(["OK", "CANCEL", "CONFIRM"], function (a, b) { if (!c[b]) throw new Error("Please supply a translation for '" + b + "'") }), q[a] = { OK: c.OK, CANCEL: c.CANCEL, CONFIRM: c.CONFIRM }, p }, p.removeLocale = function (a) { return delete q[a], p }, p.setLocale = function (a) { return p.setDefaults("locale", a) }, p.init = function (c) { return a(c || b) }, p });
</script><script type="text/javascript" src="../js/requirements.js"></script>
        <script type="text/javascript" src="../js/jquery/lobibox.js"></script>
        <script type="text/javascript" src="quickload.js"></script>

<div id="spinnerModal" class="modal fade" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog spinner">
<div class="modal-content">
<div class="modal-header modal-back modal-header-primary" style="padding-bottom: 5px;padding-top:5px; border-top-right-radius: 5px; border-top-left-radius: 5px;">
    <h3 id="myModalLabel" style="padding-top: 5px; padding-bottom: 5px; margin-top: 0px; margin-bottom: 0px;">Loading Flights...</h3></div>
<div class="modal-body"> 
<i class="fa fa-refresh fa-spin fa-2x"></i><span id="PleaseWaitSpan" style="padding-left:30px;">Please Wait</span>
</div>
</div> 
</div></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
     <script type="text/javascript">
                $(document).ready(function () {
                    $('.selectpicker').selectpicker();
                });
        </script>


<script type="text/javascript">//<![CDATA[

var ChildNeedsAdult = false; 
try {
UserCurrentLanguage = "";var onlyShowCannedFaxForSelectedFlight = false;
var highlightSelectedFlight = true;

 } catch (e) { }

//]]></script>
<script type="text/javascript">//<![CDATA[

try {
WantQuickPanels = true;
var routes = []; 
routes.push({org: 'LVI', dest: ["LUN|LUSAKA (LUN)"]  });
routes.push({org: 'LUN', dest: ["LVI|LIVINGSTONE (LVI)","MNS|MANSA (MNS)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'MNS', dest: ["LUN|LUSAKA (LUN)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'NLA', dest: ["LUN|LUSAKA (LUN)","MNS|MANSA (MNS)"]  });

var RequirementsPageTranslations = {"NoDepartureDateError" : "Please select a departure date.", "NoReturnDateError" : "Please select a return date.", "DateOrderError" : "Please select a return date after the departure date.", "LoadingFlightsMessage" : "Please wait <br />Loading flights...", "ErrorSelectingFlights" : "Error selecting flights", "MaxPassengersErrorMessage" : "The maximum number of passengers allowed in a booking is limited to ", "LargerGroupsErrorMessage" : "For larger groups, please call ..."};
RequirementsDefaultPleaseWaitMessage = "Please wait...";DefaultPleaseWaitMessage = "Please wait...";RequirementsIE6Error = "Your browser is not supported.<br /> Internet Explorer 7 is the minimum supported version. ";RequirementsDefaultErrorMessage = "An error has occurred, please contact customer services.";RequirementsCurrentLanguage = "";RequirementsDoOneShot =  false, UserCurrentLanguage = "";RequirementsEarliestBookingDate = new Date(2021, 5, 16, 0, 0, 0);RequirementsDefaultDepartureDate = new Date(0001, 0, 01, 0, 0, 0);RequirementsDefaultReturnDate = new Date(0001, 0, 01, 0, 0, 0);
RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": null, "RequirementsPage": "CustomerPanels/Requirements.aspx", "IsMultiCityBooking": false }; var SelectPaxMessage = "Please select who is travelling" ;ChildNeedsAdult = False; 
DatePickerOptions = { "ShowCalendarIcon" : true, "CalendarIconURL" : "/VARS/Public/themes/cal.bmp" }; oCurrentTheme =  { "SpinnerColour1" : "#2779aa", "SpinnerColour2" : "#e4f1fb", "SpinnerColour3" : "green", "SpinnerIcon" : 8 };  } catch (e) { }

//]]></script>
<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>
</body>
<html lang="en"><head><title>
	VARS Booking Panel
</title><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.css" rel="stylesheet"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css"><link rel="shortcut icon" href="favicon.ico"><link href="../css/bootstrap-select.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 0px;
            font-size: 12px;

        }
        .form-group {
            margin-bottom: 3px;
        }
        #divRequirementsPanel .input-group {
            padding-bottom: 2px;
        }
        button.ui-datepicker-trigger {
            display: none;
        }
        .modal-back {
            background-color: #ccc;
            border-top-left-radius: 6px;
            border-top-right-radius : 6px;
        }  

       .customTopPadding{
           padding-top:3px !important ;
       }

       .customCurrencyCorners{
           border-radius:4px !important;
       }

    </style>
        <style type="text/css">/*
 * Callouts
 *
 * Not quite alerts, but custom and helpful notes for folks reading the docs.
 * Requires a base and modifier class.
 */

/* Common styles for all types */
.bs-callout {
  padding: 20px;
  margin: 10px 0;
  border: 1px solid #eee;
  border-left-width: 5px;
  border-radius: 3px;
}
.bs-callout h4 {
  margin-top: 0;
  margin-bottom: 5px;
  margin-left: 10px;
}
.bs-callout p:last-child {
  margin-bottom: 0;
}
.bs-callout code {
  border-radius: 3px;
}

/* Tighten up space between multiple callouts */
.bs-callout + .bs-callout {
  margin-top: -5px;
}

/* Variations */
.bs-callout-danger {
  border-left-color: #ce4844;
}
.bs-callout-danger h4 {
  color: #ce4844;
}
.bs-callout-warning {
  border-left-color: #aa6708;
}
.bs-callout-warning h4 {
  color: #aa6708;
}
.bs-callout-info {
  border-left-color: #1b809e;
}
.bs-callout-info h4 {
  color: #1b809e;
}
.bs-callout-success {
  border-left-color: #70bc99;
}
.bs-callout-success h4 {
  color: #70bc99;
}
/* end callout*/


.input-group-addon.cb-beautiful input[type="checkbox"],
.input-group-addon.cb-beautiful input[type="radio"] {
    display: none;
}
.cb-beautiful {
    cursor: pointer;
}
.cb-beautiful span {
    cursor: pointer;
}
</style><style type="text/css">.btn {border-radius: 0px;}
input.form-control {border-radius: 0px;background-color: #fff; color: #000; }
#MMBLoginBody {background-color: #fff;}
#MMBLoginBody {color: #000;}
.modal-header-primary {color: #ffffff; background-color: #0866c6;}.btn-next, .btn-next.dropdown-toggle,.open button.btn-next.dropdown-toggle, .open button.btn-next.dropdown-toggle:focus {border-color: #2d2d2d; background-color: #2d2d2d; color: #ffffff;}
</style>
</head>

<body id="requirementsBody">
    <form method="post" action="./requirementsBS.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTc0NjkwNzAxMQ9kFgYCAw9kFgICAw8WAh4HVmlzaWJsZWhkAgcPFgIeCWlubmVyaHRtbAUSTG9hZGluZyBGbGlnaHRzLi4uZAIJDxYCHwEFC1BsZWFzZSBXYWl0ZGQZ/b7Myfo68EjLFMQmusLLCN2XnYMWAT7MfzuXS6Miwg==">
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="DD9D2F9C">
</div>
    <input type="hidden" id="refreshed" value="no">
    <input type="hidden" id="VarsSessionID" name="VarsSessionID" value="b0a3e04b-f572-4f0c-9528-d1dc5d6949bd" class="">


    
        
        
    <div id="divRequirementsPanel" class="divRequirementsPanel form-body form-horizontal"><div class="panel panel-default">
<div class="panel-body">
<input type="hidden" id="rqtm" name="rqtm" value="637594472809126930" class="">
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Origin" id="Origin" class="form-control"><option value="LVI">LIVINGSTONE (LVI)</option><option value="LUN" selected="selected">LUSAKA (LUN)</option><option value="MNS">MANSA (MNS)</option><option value="NLA">NDOLA (NLA)</option>
</select></div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Destination" id="Destination" class="form-control"><option value="LUN">LUSAKA (LUN)</option></select></div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<div class="col-md-12">
<div class="btn-group btn-group-sm" data-toggle="buttons"><label class="btn btn-default btn-outline btn-rounded active"><input name="ReturnTrip" id="ReturnTrip1" type="radio" checked="checked" value="chkJourneyTypeReturn"><i class="fa fa-exchange"></i> Return</label><label class="btn btn-default btn-outline btn-rounded"><input name="ReturnTrip" id="ReturnTrip2" type="radio" value="chkJourneyTypeOneWay"><i class="fa fa-long-arrow-right"></i> One Way</label></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group ">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="departuredate" name="departuredate" value="16-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="returndate" name="returndate" value="20-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfAdults" id="NumberOfAdults" class="form-control paxSelectControl"><option selected="selected" id="Adults_1" value="1">1 Adults</option><option id="Adults_2" value="2">2 Adults</option><option id="Adults_3" value="3">3 Adults</option><option id="Adults_4" value="4">4 Adults</option><option id="Adults_5" value="5">5 Adults</option><option id="Adults_6" value="6">6 Adults</option><option id="Adults_7" value="7">7 Adults</option><option id="Adults_8" value="8">8 Adults</option><option id="Adults_9" value="9">9 Adults</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfChildren" id="NumberOfChildren" class="form-control paxSelectControl"><option selected="selected" id="Children_0" value="0">0 Children</option><option id="Children_1" value="1">1 Children</option><option id="Children_2" value="2">2 Children</option><option id="Children_3" value="3">3 Children</option><option id="Children_4" value="4">4 Children</option><option id="Children_5" value="5">5 Children</option><option id="Children_6" value="6">6 Children</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfInfants" id="NumberOfInfants" class="form-control paxSelectControl"><option selected="selected" id="Infants_0" value="0">0 Infants</option><option id="Infants_1" value="1">1 Infants</option><option id="Infants_2" value="2">2 Infants</option><option id="Infants_3" value="3">3 Infants</option><option id="Infants_4" value="4">4 Infants</option><option id="Infants_5" value="5">5 Infants</option><option id="Infants_6" value="6">6 Infants</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="input-group  input-group-sm">
<input class="form-control" type="text" id="EVoucher" placeholder="EVoucher" name="EVoucher"><span class="input-group-addon"><i class="fa fa-tag"></i></span></div>
</div>
</div>
</div>
<div class="panel-footer">
<div class="row">
<div class="col-md-12 text-center">
<div class="input-group  input-group-sm">
<button id="submitButton" class="btn btn-default btn-next" type="submit">Continue</button></div>
</div>
</div>
</div>
</div>
</div>
    <div id="GrandMasterDialog"></div>
    <div id="RequirementsLoadingProgressDialog"></div>
    </form>
       <div id="dialog-message" style="display: none;" title="Information">
        <p>
            <span id="msgSpan">Searching for flights</span>
            <br><br>
        </p>
            <div class="LoadingProgressImage"></div>
    </div>


    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-json/2.5.1/jquery.json.min.js"></script>
    <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script type="text/javascript">/*
    Flights.js
*/
var fareClassMatch = '';
var ClassBandMustMatch = false;
var UseTraditionalReturnFares = false;

var FlightSelectTranslations = null;
var RequirementsPageTranslations = null;
var divNextPreviousDayAvailability = null;
var mmbChangeFlightMode = '';
var oFirstJourneySelected = null;
var oPreviousFirstJourneyFareSelected = null;
var RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": false };
var FlightSelectNextPage = "BookingOptions.aspx";
var FlightSelectAirMilesValidated = false;
var sEVoucher = "";
var RequirementsEarliestBookingDate = null;
var sOriginCityCode = "";
var sDestinationCityCode = "";
var sHomeCityCode = "";
var sDepartureDate = "";
var sReturnDate = "";
var dDefaultDepartureDate = null;
var dDefaultReturnDate = null;
var RequirementsDefaultDepartureDate = null;
var RequirementsDefaultReturnDate = null;
var RequirementsDoOneShot = null;
var AvUrl = "../WebServices/AvailabilityWS.asmx/GetFlightAvailability";
var DestCityUrl = "../WebServices/Airports.asmx/DestinationCityList";
var addFltUrl = "WebServices/AvailabilityWS.asmx/AddFlightToBasket";
var changeDayUrl = "WebServices/AvailabilityWS.asmx/ChangeDay";

function InitAvailabilityDisplay() {
    try {
        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").parent().unbind("click").click(function () {
            //SelectAvailabilityFare(jQuery(this));
            var rb = $(this).find("input[id^=optCalendarAvailabilityFare][type=radio]");
            $(rb).prop('checked', true);
            SelectAvailabilityFare(jQuery(rb));
            //return false;
        });

        $("#radio-jquery-ui").buttonset();

        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").unbind("click").click(function () {
            //    SelectAvailabilityFare(jQuery(this));
            //  return false;
        });

        /*
        $(".refineSearchType").unbind("click").click(function () {
            var rb = $(this).find("input[id=ReturnTrip][type=radio]");
            $(rb).prop('checked', true);
           // return false;
        });
        */

        jQuery("div[id^=divFlightAvailabilityPreviousDay], div[id^=divFlightAvailabilityNextDay]").unbind("click").click(function () {
            NextDayPreviousDay_onClick(jQuery(this));
        });


        if (ClassBandMustMatch) {
            if (fareClassMatch !== '') {
                HideOrDisableUnwantedFares('');
            } else {
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 0) {
                    var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                    HideOrDisableUnwantedFares(tempFareData);
                }
            }
        }

        InitialiseRefineSearch(null);
        InitialiseGenericRefineSearch();
    } catch (e) { var xa = 1;}

}
function InitialiseGenericRefineSearch() {
    try {
        $('.dropdown-menu input, .dropdown-menu label, .dropdown-menu select').click(function (e) {
            e.stopPropagation();
        });
    } catch (e) { var xb = 1;}


    try {
        //if (jQuery("div[id$=RefineSearchWhoIsTravelling]").length == 1) {
        jQuery("#NumberOfAdults").change(function () {
            var noAdultsSelected = parseInt(jQuery(this).val());

            if (noAdultsSelected < 0) { noAdultsSelected = 0; }
            if (jQuery("#NumberOfInfants").length > 0) {
                var fldInfants = jQuery("#NumberOfInfants");
                var noOptions = fldInfants.children().length;

                noAdultsSelected += 1;
                if (noOptions > (noAdultsSelected)) {
                    fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
                } else {
                    for (var i = noOptions; ((i < noAdultsSelected) && (i <= RequirementsProperties.MaxInfants)) ; i++) {
                        fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                    }
                }
            }
        });
        //}
    } catch (e) { var xc = 1; }
}
function AddFlightToBasket_onSuccess(msg) {
    if ( msg !== null &&  msg.Data !== "" ) {
        $("#divBasket2").html(msg.Data);
        try { $("#divMiniBasket").html(msg.Data2); } catch (e) { var x4 = 1;}
        try { $("#BandText").html(msg.DialogCaption); } catch (e) { var x3 = 1; }
        try { InitBasket(); } catch (e) { var x = 1;}
        try { OnPageLoad(); } catch (e) { var x1 = 1; }
    }
   // RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
}

function AddFlightToBasket_onError(ErrorMsg) {

    var dlgMsg = new Object;
    dlgMsg.OkAction = "RefreshPage()";
    dlgMsg.html = ErrorMsg;

    modalDialog(dlgMsg);

        //var oButtons = { "Ok": function() {           
        //    // refresh page
        //    //window.location.reload(true);
        //    RefreshPage();
        //    jQuery(this).dialog("destroy");
        //    }
        //};
        //if (RequirementsPageTranslations != null) {
        //    ShowModalDialog(ErrorMsg, RequirementsPageTranslations.ErrorSelectingFlights, 0, 0, oButtons);
        //} else {
        //    ShowModalDialog(ErrorMsg, "Warning", 0, 0, oButtons);
        //}

}

function HideOrDisableUnwantedFares(tempFareData) {
    // disable radio buttons
    var thisClass;
    
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().append('<span class="na">NA</span>');

    if (fareClassMatch !== '') {
        thisClass = fareClassMatch;
    } else {
        var vals = tempFareData.split("_");


        if (mmbChangeFlightMode === true) {
            if (jQuery(".FlightAvailabilityTable").length > 1) {
                // enable this direction
                var thisDirection = vals[0] + "_" + vals[1] + "_";
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
            }
        } else {
            // enable this direction
            thisDirection = vals[0] + "_" + vals[1] + "_";
            //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").show();
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
        }

        // enable this class
        thisClass = "_" + vals[4];
    }
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").show();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().remove(".na");
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().show();

}


function SelectAvailabilityFare(selectedFareOption) {
    var fareData = null;
    var sFormData = "";
    var sPleaseWaitMessage = "";
    var InvalidSelectedFares = "";
    var oRegExp = new RegExp("'", "g");
    var bContinue = true;

    try {
        if (ClassBandMustMatch) {
            if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length === 1) {
                // get code
                var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").val();
                HideOrDisableUnwantedFares(tempFareData);
            } else if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 1) {
                // any radio buttons in jouneys > first, not in first's class, to be de-selected
                tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                var vals = tempFareData.split("_");
                var thisClass = vals[4];
                var changes = 0;

                jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var tFareData = jQuery(this).val();
                    vals = tFareData.split("_");
                    if (vals[4] !== thisClass) {
                        $(this).attr("checked", false);
                        changes++;
                    }
                });

                if (changes > 0) {
                    HideOrDisableUnwantedFares(tempFareData);
                }

            }
        }

        if ((jQuery("input:checked[id=RedeemAirMiles]").length === 1) || (jQuery("#chkAvailabilityFFRedeemAirMiles").length === 1)) {
            HideOrDisableExpensiveAirmiles();
        }


       
        var arfareData = [];
        if (UseTraditionalReturnFares) {
            var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
            var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;
            var bValidCombinableFaresSelected = false;

            if (iAvailabilityCount === 2) {
                bContinue = CheckValidReturnCombinableFares(selectedFareOption);
            }
            if ((!bContinue) || (iAvailabilityCount !== iSelectedAvailability)) {
                try { ShowCannedFaxInfo(); } catch (e) { var x = 1;}
                try { highlightSelected(); } catch (e) { var y = 1;}
                return false;
            }

            jQuery("input:checked[id^=optCalendarAvailabilityFare][type=radio]").each(function () {
                var tempFareData = jQuery(this).val();
                tempFareData = tempFareData.toString().replace(oRegExp, "\"");
                InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
                if (InvalidSelectedFares.length > 0) { tempFareData = tempFareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
                if (fareData !== null) {
                    fareData += ", ";
                } else {
                    fareData = "";
                }
                fareData += "'" + tempFareData + "'";
                arfareData.push(tempFareData);
            });
        } else {
            fareData = selectedFareOption.val();
            fareData = fareData.toString().replace(oRegExp, "\"");
            InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
            if (InvalidSelectedFares.length > 0) { fareData = fareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
            fareData = "'" + fareData + "'";
            arfareData.push(fareData);
        }

        try { ShowCannedFaxInfo(); } catch (e) { var x1 = 1;}
        try { highlightSelected(); } catch (e) { var x2 = 1;}

        //sFormData = "{ 'FormData': [" + fareData + "] }";
        var rq = new Object;
        rq.addFlightRequest = new Object;
        rq.addFlightRequest.VarsSessionID = $('#VarsSessionID').val();

        rq.addFlightRequest.fareData = arfareData;
        rq.addFlightRequest.Zone = "PUBLIC";

        try { sPleaseWaitMessage = CheckFlightsTranslations.AddingFlightToBasketMessage; } catch (e) { var x3 = 1; }
        var url = addFltUrl;
        if ( (new RegExp("/Agent/", "i")).test(window.location.href) ) {
            // agent page
            url = "../" + url;
            rq.addFlightRequest.Zone = "AGENT";
        }
        if ((new RegExp("/mmb/", "i")).test(window.location.href)  ){
            // mmb page
            url = "../" + url;
            rq.addFlightRequest.Zone = "MMB";
        }
        if ((new RegExp("/fqtv/", "i")).test(window.location.href)) {
            // mmb page
            url = "../" +url;
            rq.addFlightRequest.Zone = "FQTV";
        }

        SendAjaxRequest(url, $.toJSON(rq), null, AddFlightToBasket_onSuccess, AddFlightToBasket_onError, "", true, sPleaseWaitMessage);
    } catch (e) {
        var msg = e.message;
    }
}

function HideOrDisableExpensiveAirmiles() {
    // un-hide any hidden previously
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().show();

    // do hiding
    jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
        try {
            // get outstanding miles
            var selFare = jQuery(this).val();
            var selFareVals = selFare.split("_");
            var milesSpent = $.trim(jQuery(this).parent().text());
            var totalMilesAvailable = $.trim($(".milesTotal span").html()).replace(",", "");
            if (totalMilesAvailable !== "") {
                // logged in with miles to spend
                var milesLeft = parseInt(totalMilesAvailable, 10) - parseInt(milesSpent, 10)
                var otherDirection;
                if (selFareVals[1] === '0') {
                    otherDirection = selFareVals[0] + "_1_";
                } else {
                    otherDirection = selFareVals[0] + "_0_";
                }
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").length > 0) {
                    // remove value of existing fare this journey
                    milesLeft += parseInt(jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").val());
                }
                // hide if too expensive
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").each(function () {
                    var miles = parseInt($.trim($(this).parent().text()), 10);
                    if (miles > milesLeft) {
                        $(this).parent().children().hide();
                    }
                });
            }
        } catch (e) { var x = 1;}
    });
}


function ShowCannedFaxInfo() {
    if (onlyShowCannedFaxForSelectedFlight) {
        // hide all canned fax
        $(".InfoColumn").children().hide();
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).each(function () {
            $(this).next().children('.InfoColumn').children().show().removeClass("hidden");
        });
    }
}

function highlightSelected() {
    if (highlightSelectedFlight) {
        // hide all highlighting
        $(".AvailabilityRow, .AvailabilityTableFlightDivider, .AvailabilityTableConnectingFlightDivider, .AvailabilityTableCannedFactsDivider").removeClass('ui-state-highlight');
        $(".AvailabilityRow td, .AvailabilityTableFlightDivider td, .AvailabilityTableConnectingFlightDivider td, .AvailabilityTableCannedFactsDivider td").removeClass('ui-state-highlight');
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).addClass('ui-state-highlight');
        $(par).children("td").addClass('ui-state-highlight');
        $(par).each(function () {
            CheckHighlightNext(this);
            //if ($(this).hasClass("AvailabilityTableConnectingFlightDivider")) {
            //    $(this).next().addClass('ui-state-highlight');
            //}
        });
    }
}
function CheckHighlightNext(obj) {
    if ($(obj).hasClass("AvailabilityTableConnectingFlightDivider")) {
        $(obj).next().addClass('ui-state-highlight');
        // carry on loop! - careful
        CheckHighlightNext($(obj).next());
    }
}

function CheckValidReturnCombinableFares(selectedFareOption) {
    var fareData = null;
    var selectedFareTable = null;
    var bFareSelected = false;
    var bValidFare = false;
    var bInvalidFareSelected = false;
    var SelectedJourneyFareData = null;

    try {
        oPreviousFirstJourneyFareSelected = null;
        SelectedJourneyFareData = GetFareObjectData(selectedFareOption.get(0));
        var bIsCombinableFare = SelectedJourneyFareData.IsCombinableFareClass;
        var bHasReturnFare = SelectedJourneyFareData.FareClassHasReturnFare;
        if (oFirstJourneySelected === null) {
            oFirstJourneySelected = SelectedJourneyFareData.FlightAvailabilityTableClientID;
        } else {
            if (SelectedJourneyFareData.FlightAvailabilityTableClientID !== oFirstJourneySelected) return true;
        }

        jQuery("table[id^=tblFlightAvailability]").each(function () {
            var oTable = jQuery(this);
            if (oTable.attr("id") !== SelectedJourneyFareData.FlightAvailabilityTableClientID) { //selectedFareTable.attr("id")
                oTable.find("input[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var fareObject = jQuery(this).get(0);
                    var fareObjectData = GetFareObjectData(fareObject);

                    bFareSelected = fareObject.checked;
                    bValidFare = false;
                    if ((bIsCombinableFare) && (fareObjectData.IsCombinableFareClass)) {
                        bValidFare = true;
                    } else {
                        if ((bHasReturnFare) && ((new RegExp(SelectedJourneyFareData.SelectedFareClass, "i")).test(fareObjectData.SelectedFareClass))) {
                            var sReturnFareRoute = "";
                            if (SelectedJourneyFareData.FlightAvailabilityTableClientID === "tblFlightAvailability0_0_0") {
                                sReturnFareRoute = SelectedJourneyFareData.FareRoute + fareObjectData.FareRoute.substr(3);
                            } else {
                                sReturnFareRoute = fareObjectData.FareRoute + SelectedJourneyFareData.FareRoute.substr(3);
                            }

                            if ((new RegExp(sReturnFareRoute, "i")).test(SelectedJourneyFareData.ReturnFareRoutes)) {
                                bValidFare = true;
                            }
                        }
                    }

                    if (!bValidFare) {
                        if (!bInvalidFareSelected && bFareSelected) { bInvalidFareSelected = true; }
                        fareObject.checked = false;
                    }
                    fareObject.disabled = !bValidFare;
                });
            }
        });

        //return false;
        if (bInvalidFareSelected) {
            oPreviousFirstJourneyFareSelected = selectedFareOption;
            jQuery("#divEmptyShoppingBasket").unbind("click").click();
            return true;
        } else {
            return true;
        }
    } catch (e) { var x = 1;}
}

function GetFareObjectData(fareObject) {
    var fareObjectData = null;
    var oRegExp = new RegExp("'", "g");

    try {
        fareObjectData = jQuery.parseJSON(fareObject.value.toString().replace(oRegExp, "\""));
        var sID_Indices = fareObject.id.replace("optCalendarAvailabilityFare", "") + "_" + fareObjectData.JourneyIndex + "_" + fareObjectData.FlightLegIndex;
        var fareObjectDateField = jQuery("#hfldCalendarAvailabilityDepDateTime" + sID_Indices);
        fareObjectData.SelectedFareDate = Date.parse(fareObjectDateField.val());
        fareObjectData.FlightDuration = jQuery("#hfldCalendarAvailabilityDuration" + sID_Indices).val();
        fareObjectData.MinConnectionTime = jQuery("#hfldCalendarAvailabilityMinConnectionTime" + sID_Indices).val();
    } catch (e) {
        fareObjectData = new Object;

    }

    return fareObjectData;
}

function ValidateSelectedFlights() {
    try {
        var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
        var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;

        //        if (ShoppingBasket2.UseBasket2 == true) {
        if ((!ShoppingBasket2.IsBasketEmpty) && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount) {
            return true;
        }
        if (iSelectedAvailability === 0) {
            try { modalDialog(flightSelectPageTranslationsMsgs.FlightSelectionErrorMessage); } catch (e) {var x = 1;}
            return false;
        }
        if ((iAvailabilityCount > 1) && (iSelectedAvailability > 0) && (iSelectedAvailability !== iAvailabilityCount)) {
            try { modalDialog(flightSelectPageTranslationsMsgs.ReturnFlightSelectionErrorMessage); } catch (e) {                var x5 = 1;}
            return false;

        }

            return (!ShoppingBasket2.IsBasketEmpty && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount);
        //} else {
        //    return ((!oCurrentShoppingBasket.IsBasketEmpty) && (iSelectedAvailability > 0) && (iSelectedAvailability == iAvailabilityCount));
        //}
    } catch (e) {
        return false;
    }
}

function ToggleFlightAvailabilityAirMilesMode_onSuccess(msg) {
    try {
        if (msg.Data !== null && msg.Data.length > 0) {
            jQuery("div[id$=divFlightAvailabilityFound]").html(msg.Data);
            // InitialiseCheckFlightsObjects(null);
            RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
            InitAvailabilityDisplay();
        }
    } catch (e) {        var x = 1; }
}

function GetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
        $("#Destination").val(sDestinationCityCode);
    } catch (e) {        var x = 1; }

}

function InitRequirements() {

    $('.requirementsInnerContent').show();
    //KeepAlive();

    if (RequirementsDoOneShot === true) {
        SendAjaxRequest("../WebServices/Airports.asmx/OneShotLoad", "", "html", RequirementsOneShotLoad_onSuccess, null, "");
    }


    $(".requirementsLabel").unbind("click").click(function () {
    });

    $("#radio-jquery-ui").buttonset();

    try { InitialiseDatePicker(); } catch (e) {        var x = 1;}

    if (RequirementsEarliestBookingDate !== null) {
        jQuery("#departuredate, #returndate").datepicker("option", "minDate", RequirementsEarliestBookingDate);
    }

    if (RequirementsDefaultDepartureDate !== null && jQuery("#departuredate").datepicker("getDate") !== RequirementsDefaultDepartureDate) {
        jQuery("#departuredate").datepicker("setDate", RequirementsDefaultDepartureDate);
    }

    if (RequirementsDefaultReturnDate !== null && jQuery("input[name=ReturnTrip]:radio:checked").length === 1) {
        jQuery("#returndate").datepicker("setDate", RequirementsDefaultReturnDate);
    }

    jQuery("#departuredate").change(function () {
        var dSelectedDepartureDate = jQuery(this).datepicker("getDate");
        jQuery("#returndate").datepicker("option", "minDate", dSelectedDepartureDate);
        if (jQuery('input[name=ReturnTrip]:radio:checked').val() === 'chkJourneyTypeReturn' && jQuery("#returndate").val().length === 0) {
            jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate);
        }
        try { if (RequirementsProperties.AutoUpdateReturnDate !== null) { jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate.addDays(RequirementsProperties.AutoUpdateReturnDate)); } }
        catch (e) {
            var x = 1;
    }
    });

    jQuery("#NumberOfAdults").change(function () {
        var noAdultsSelected = parseInt(jQuery(this).val());

        if (noAdultsSelected < 0) { noAdultsSelected = 0; }
        if (jQuery("#NumberOfInfants").length > 0) {
            var fldInfants = jQuery("#NumberOfInfants");
            var noOptions = fldInfants.children().length;

            noAdultsSelected += 1;
            if (noOptions > noAdultsSelected) {
                fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
            } else {
                for (var i = noOptions; (i < noAdultsSelected && i <= RequirementsProperties.MaxInfants) ; i++) {
                    fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                }
            }
        }
    });

    $('#Origin').change(function () {
        SendAjaxRequest(DestCityUrl, "{'origin':'" + $('#Origin').val() + "'}", "html", RequirementsGetDestinations_onSuccess, null, "");
    });

    $('input[name=ReturnTrip]:radio').change(function () {
        if ($('input[name=ReturnTrip]:radio:checked').val() !== 'chkJourneyTypeReturn')
            $('.requirementsReturning').hide();
        else
            $('.requirementsReturning').show();
    });

    $('#submitButton').click(function (e) {

        var wsRq = BuildAvSearch(e);
        wsRq.SearchUser = "PUBLIC";
        if (wsRq !== false) {
            var sFormData = '{"FormData":' + $.toJSON(wsRq) + ',"IsMMBChangeFlightMode":false, "IsRefineSerach": false}';

            SendAjaxRequest(AvUrl, sFormData, null, RequirementsDoSubmit_onSuccess, RequirementsDoSubmit_onError, null, true, null);
        }
        return false;
    });
    // hover effects
    jQuery(".ui-button.ui-state-active").hover(
        function () { jQuery(this).removeClass("ui-state-active").addClass("ui-state-hover"); },
        function () { jQuery(this).removeClass("ui-state-hover").addClass("ui-state-active"); }
    ); //end hover
    InitChildCheck();
}

function InitChildCheck() {
    try {
        if (ChildNeedsAdult == true ) {
            // check on change no children
            $("#NumberOfChildren").unbind("change").change(function (e) {
                var noSelected = parseInt(jQuery(this).val());
                if (noSelected > 0) {
                    $("#Adults_0").wrap('<span/>');
                } else {
                    $("#Adults_0").unwrap();
                }
            });

            // check current settings
            DoChildCheck($("#NumberOfChildren"));
        }
    }
    catch (e) {
        
    }    
}
function DoChildCheck(obj) {
    var noSelected = parseInt(jQuery(obj).val());
    if (noSelected > 0) {
        $("#Adults_0").wrap('<span/>');
    
    }
}



//function GetHomeCity_onSuccess(msg) {

//    try {
//        sHomeCityCode = msg;
//    } catch (e) { }

//}

function GetOrigins_onSuccess(msg) {

    try {
        $("#Origin").html(msg);
        $("#Origin").val(sHomeCityCode);
        $("#Origin").change();
    } catch (e) {
        var x = 1;
    }

}

function RequirementsOneShotLoad_onSuccess(msg) {

    try {
        var o = jQuery.parseJSON(msg);

        sHomeCityCode = o.HomeCity;
        $("#Origin").html(o.OriginList);
        if (o.SelectedOriginCity.length > 0) {
            $("#Origin").val(o.SelectedOriginCity);
        } else {
            $("#Origin").val(sHomeCityCode);
        }
        $("#Destination").html(o.DestinationList);
        if (o.SelectedDestinationCity.length > 0) { $("#Destination").val(o.SelectedDestinationCity); }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsGetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onSuccess(msg) {

    try {
        if (msg.Result === 'OK') {
            if (msg.NextURL !== '') {
                switch ($('#formRequirements').attr('target')) {
                    case '_blank':
                        window.open(msg.NextURL);
                        break;
                    case '_top':
                    default:
                        // window.top.location = msg.NextURL; // +"?VarsSessionID=" + $("#VarsSessionID").val(); 
                        PostToPage(msg.NextURL);
                }
                try { ShowLoadingProgressDialog(RequirementsPageTranslations.LoadingFlightsMessage); } catch (e) { var xv = 1;}
            }
        } else {
            // ShowRequirementsModalDialog(msg.ErrorMsg);
            WsServerErrorDialog(msg);
        }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onError(errorText, msg) {

    try {
        var $p = $('<p class="RequirementsDialog"></p>').hide().appendTo("body");
        var dlgH = parseInt($p.css("height").replace("px", ""), 10);
        var dlgW = parseInt($p.css("width").replace("px", ""), 10);
        $p.remove();

        ShowModalDialog(errorText, "Search Error", dlgH, dlgW);

    } catch (e) {
        var x = 1;

    }

}

</script><script type="text/javascript">function InitBeautifulCheckbox() {
    $('.input-group-addon.cb-beautiful').each(function () {

        var $widget = $(this),
            $input = $widget.find('input'),
            type = $input.attr('type');
        settings = {
            checkbox: {
                on: { icon: 'fa fa-1-5x fa-check-square-o' },
                off: { icon: 'fa fa-1-5x fa-square-o' }
            },
            radio: {
                on: { icon: 'fa fa-dot-circle-o' },
                off: { icon: 'fa fa-circle-o' }
            }
        };
        if ($widget.find('span').length == 0) {
            $widget.prepend('<span class="' + settings[type].off.icon + '"></span>');
        }
        $widget.unbind("click").click(function () {
            $input.prop('checked', !$input.is(':checked'));
            $input.trigger("change");
            updateDisplay();
        });

        function updateDisplay() {
            var isChecked = $input.is(':checked') ? 'on' : 'off';

            $widget.find('.fa').attr('class', settings[type][isChecked].icon);

            //Just for desplay
            //isChecked = $input.is(':checked') ? 'checked' : 'not Checked';
            //$widget.closest('.input-group').find('input[type="text"]').val('Input is currently ' + isChecked)
        }

        updateDisplay();
    });
}

jQuery(document).ready(function () {
    InitBeautifulCheckbox();
});
</script><script type="text/javascript">/**
 * bootbox.js v4.4.0
 *
 * http://bootboxjs.com/license.txt
 */
!function (a, b) { "use strict"; "function" == typeof define && define.amd ? define(["jquery"], b) : "object" == typeof exports ? module.exports = b(require("jquery")) : a.bootbox = b(a.jQuery) }(this, function a(b, c) { "use strict"; function d(a) { var b = q[o.locale]; return b ? b[a] : q.en[a] } function e(a, c, d) { a.stopPropagation(), a.preventDefault(); var e = b.isFunction(d) && d.call(c, a) === !1; e || c.modal("hide") } function f(a) { var b, c = 0; for (b in a) c++; return c } function g(a, c) { var d = 0; b.each(a, function (a, b) { c(a, b, d++) }) } function h(a) { var c, d; if ("object" != typeof a) throw new Error("Please supply an object of options"); if (!a.message) throw new Error("Please specify a message"); return a = b.extend({}, o, a), a.buttons || (a.buttons = {}), c = a.buttons, d = f(c), g(c, function (a, e, f) { if (b.isFunction(e) && (e = c[a] = { callback: e }), "object" !== b.type(e)) throw new Error("button with key " + a + " must be an object"); e.label || (e.label = a), e.className || (e.className = 2 >= d && f === d - 1 ? "btn-primary" : "btn-default") }), a } function i(a, b) { var c = a.length, d = {}; if (1 > c || c > 2) throw new Error("Invalid argument length"); return 2 === c || "string" == typeof a[0] ? (d[b[0]] = a[0], d[b[1]] = a[1]) : d = a[0], d } function j(a, c, d) { return b.extend(!0, {}, a, i(c, d)) } function k(a, b, c, d) { var e = { className: "bootbox-" + a, buttons: l.apply(null, b) }; return m(j(e, d, c), b) } function l() { for (var a = {}, b = 0, c = arguments.length; c > b; b++) { var e = arguments[b], f = e.toLowerCase(), g = e.toUpperCase(); a[f] = { label: d(g) } } return a } function m(a, b) { var d = {}; return g(b, function (a, b) { d[b] = !0 }), g(a.buttons, function (a) { if (d[a] === c) throw new Error("button key " + a + " is not allowed (options are " + b.join("\n") + ")") }), a } var n = { dialog: "<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>", header: "<div class='modal-header modal-header-primary'><h4 class='modal-title'></h4></div>", footer: "<div class='modal-footer'></div>", closeButton: "<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>", form: "<form class='bootbox-form'></form>", inputs: { text: "<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />", textarea: "<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>", email: "<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />", select: "<select class='bootbox-input bootbox-input-select form-control'></select>", checkbox: "<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>", date: "<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />", time: "<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />", number: "<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />", password: "<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />" } }, o = { locale: "en", backdrop: "static", animate: !0, className: null, closeButton: !0, show: !0, container: "body" }, p = {}; p.alert = function () { var a; if (a = k("alert", ["ok"], ["message", "callback"], arguments), a.callback && !b.isFunction(a.callback)) throw new Error("alert requires callback property to be a function when provided"); return a.buttons.ok.callback = a.onEscape = function () { return b.isFunction(a.callback) ? a.callback.call(this) : !0 }, p.dialog(a) }, p.confirm = function () { var a; if (a = k("confirm", ["cancel", "confirm"], ["message", "callback"], arguments), a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, !1) }, a.buttons.confirm.callback = function () { return a.callback.call(this, !0) }, !b.isFunction(a.callback)) throw new Error("confirm requires a callback"); return p.dialog(a) }, p.prompt = function () { var a, d, e, f, h, i, k; if (f = b(n.form), d = { className: "bootbox-prompt", buttons: l("cancel", "confirm"), value: "", inputType: "text" }, a = m(j(d, arguments, ["title", "callback"]), ["cancel", "confirm"]), i = a.show === c ? !0 : a.show, a.message = f, a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, null) }, a.buttons.confirm.callback = function () { var c; switch (a.inputType) { case "text": case "textarea": case "email": case "select": case "date": case "time": case "number": case "password": c = h.val(); break; case "checkbox": var d = h.find("input:checked"); c = [], g(d, function (a, d) { c.push(b(d).val()) }) } return a.callback.call(this, c) }, a.show = !1, !a.title) throw new Error("prompt requires a title"); if (!b.isFunction(a.callback)) throw new Error("prompt requires a callback"); if (!n.inputs[a.inputType]) throw new Error("invalid prompt type"); switch (h = b(n.inputs[a.inputType]), a.inputType) { case "text": case "textarea": case "email": case "date": case "time": case "number": case "password": h.val(a.value); break; case "select": var o = {}; if (k = a.inputOptions || [], !b.isArray(k)) throw new Error("Please pass an array of input options"); if (!k.length) throw new Error("prompt with select requires options"); g(k, function (a, d) { var e = h; if (d.value === c || d.text === c) throw new Error("given options in wrong format"); d.group && (o[d.group] || (o[d.group] = b("<optgroup/>").attr("label", d.group)), e = o[d.group]), e.append("<option value='" + d.value + "'>" + d.text + "</option>") }), g(o, function (a, b) { h.append(b) }), h.val(a.value); break; case "checkbox": var q = b.isArray(a.value) ? a.value : [a.value]; if (k = a.inputOptions || [], !k.length) throw new Error("prompt with checkbox requires options"); if (!k[0].value || !k[0].text) throw new Error("given options in wrong format"); h = b("<div/>"), g(k, function (c, d) { var e = b(n.inputs[a.inputType]); e.find("input").attr("value", d.value), e.find("label").append(d.text), g(q, function (a, b) { b === d.value && e.find("input").prop("checked", !0) }), h.append(e) }) } return a.placeholder && h.attr("placeholder", a.placeholder), a.pattern && h.attr("pattern", a.pattern), a.maxlength && h.attr("maxlength", a.maxlength), f.append(h), f.on("submit", function (a) { a.preventDefault(), a.stopPropagation(), e.find(".btn-primary").click() }), e = p.dialog(a), e.off("shown.bs.modal"), e.on("shown.bs.modal", function () { h.focus() }), i === !0 && e.modal("show"), e }, p.dialog = function (a) { a = h(a); var d = b(n.dialog), f = d.find(".modal-dialog"), i = d.find(".modal-body"), j = a.buttons, k = "", l = { onEscape: a.onEscape }; if (b.fn.modal === c) throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details."); if (g(j, function (a, b) { k += "<button data-bb-handler='" + a + "' type='button' class='btn " + b.className + "'>" + b.label + "</button>", l[a] = b.callback }), i.find(".bootbox-body").html(a.message), a.animate === !0 && d.addClass("fade"), a.className && d.addClass(a.className), "large" === a.size ? f.addClass("modal-lg") : "small" === a.size && f.addClass("modal-sm"), a.title && i.before(n.header), a.closeButton) { var m = b(n.closeButton); a.title ? d.find(".modal-header").prepend(m) : m.css("margin-top", "-10px").prependTo(i) } return a.title && d.find(".modal-title").html(a.title), k.length && (i.after(n.footer), d.find(".modal-footer").html(k)), d.on("hidden.bs.modal", function (a) { a.target === this && d.remove() }), d.on("shown.bs.modal", function () { d.find(".btn-primary:first").focus() }), "static" !== a.backdrop && d.on("click.dismiss.bs.modal", function (a) { d.children(".modal-backdrop").length && (a.currentTarget = d.children(".modal-backdrop").get(0)), a.target === a.currentTarget && d.trigger("escape.close.bb") }), d.on("escape.close.bb", function (a) { l.onEscape && e(a, d, l.onEscape) }), d.on("click", ".modal-footer button", function (a) { var c = b(this).data("bb-handler"); e(a, d, l[c]) }), d.on("click", ".bootbox-close-button", function (a) { e(a, d, l.onEscape) }), d.on("keyup", function (a) { 27 === a.which && d.trigger("escape.close.bb") }), b(a.container).append(d), d.modal({ backdrop: a.backdrop ? "static" : !1, keyboard: !1, show: !1 }), a.show && d.modal("show"), d }, p.setDefaults = function () { var a = {}; 2 === arguments.length ? a[arguments[0]] = arguments[1] : a = arguments[0], b.extend(o, a) }, p.hideAll = function () { return b(".bootbox").modal("hide"), p }; var q = { br: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Sim" },  da: { OK: "OK", CANCEL: "Annuller", CONFIRM: "Accepter" }, de: { OK: "OK", CANCEL: "Abbrechen", CONFIRM: "Akzeptieren" },  en: { OK: "OK", CANCEL: "Cancel", CONFIRM: "OK" }, es: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Aceptar" }, et: { OK: "OK", CANCEL: "Katkesta", CONFIRM: "OK" }, fi: { OK: "OK", CANCEL: "Peruuta", CONFIRM: "OK" }, fr: { OK: "OK", CANCEL: "Annuler", CONFIRM: "D'accord" },  hr: { OK: "OK", CANCEL: "Odustani", CONFIRM: "Potvrdi" }, id: { OK: "OK", CANCEL: "Batal", CONFIRM: "OK" }, it: { OK: "OK", CANCEL: "Annulla", CONFIRM: "Conferma" },  nl: { OK: "OK", CANCEL: "Annuleren", CONFIRM: "Accepteren" }, no: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, pl: { OK: "OK", CANCEL: "Anuluj", CONFIRM: "PotwierdÅº" }, pt: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Confirmar" },  sq: { OK: "OK", CANCEL: "Anulo", CONFIRM: "Prano" }, sv: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, }; return p.addLocale = function (a, c) { return b.each(["OK", "CANCEL", "CONFIRM"], function (a, b) { if (!c[b]) throw new Error("Please supply a translation for '" + b + "'") }), q[a] = { OK: c.OK, CANCEL: c.CANCEL, CONFIRM: c.CONFIRM }, p }, p.removeLocale = function (a) { return delete q[a], p }, p.setLocale = function (a) { return p.setDefaults("locale", a) }, p.init = function (c) { return a(c || b) }, p });
</script><script type="text/javascript" src="../js/requirements.js"></script>
        <script type="text/javascript" src="../js/jquery/lobibox.js"></script>
        <script type="text/javascript" src="quickload.js"></script>

<div id="spinnerModal" class="modal fade" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog spinner">
<div class="modal-content">
<div class="modal-header modal-back modal-header-primary" style="padding-bottom: 5px;padding-top:5px; border-top-right-radius: 5px; border-top-left-radius: 5px;">
    <h3 id="myModalLabel" style="padding-top: 5px; padding-bottom: 5px; margin-top: 0px; margin-bottom: 0px;">Loading Flights...</h3></div>
<div class="modal-body"> 
<i class="fa fa-refresh fa-spin fa-2x"></i><span id="PleaseWaitSpan" style="padding-left:30px;">Please Wait</span>
</div>
</div> 
</div></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
     <script type="text/javascript">
                $(document).ready(function () {
                    $('.selectpicker').selectpicker();
                });
        </script>


<script type="text/javascript">//<![CDATA[

var ChildNeedsAdult = false; 
try {
UserCurrentLanguage = "";var onlyShowCannedFaxForSelectedFlight = false;
var highlightSelectedFlight = true;

 } catch (e) { }

//]]></script>
<script type="text/javascript">//<![CDATA[

try {
WantQuickPanels = true;
var routes = []; 
routes.push({org: 'LVI', dest: ["LUN|LUSAKA (LUN)"]  });
routes.push({org: 'LUN', dest: ["LVI|LIVINGSTONE (LVI)","MNS|MANSA (MNS)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'MNS', dest: ["LUN|LUSAKA (LUN)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'NLA', dest: ["LUN|LUSAKA (LUN)","MNS|MANSA (MNS)"]  });

var RequirementsPageTranslations = {"NoDepartureDateError" : "Please select a departure date.", "NoReturnDateError" : "Please select a return date.", "DateOrderError" : "Please select a return date after the departure date.", "LoadingFlightsMessage" : "Please wait <br />Loading flights...", "ErrorSelectingFlights" : "Error selecting flights", "MaxPassengersErrorMessage" : "The maximum number of passengers allowed in a booking is limited to ", "LargerGroupsErrorMessage" : "For larger groups, please call ..."};
RequirementsDefaultPleaseWaitMessage = "Please wait...";DefaultPleaseWaitMessage = "Please wait...";RequirementsIE6Error = "Your browser is not supported.<br /> Internet Explorer 7 is the minimum supported version. ";RequirementsDefaultErrorMessage = "An error has occurred, please contact customer services.";RequirementsCurrentLanguage = "";RequirementsDoOneShot =  false, UserCurrentLanguage = "";RequirementsEarliestBookingDate = new Date(2021, 5, 16, 0, 0, 0);RequirementsDefaultDepartureDate = new Date(0001, 0, 01, 0, 0, 0);RequirementsDefaultReturnDate = new Date(0001, 0, 01, 0, 0, 0);
RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": null, "RequirementsPage": "CustomerPanels/Requirements.aspx", "IsMultiCityBooking": false }; var SelectPaxMessage = "Please select who is travelling" ;ChildNeedsAdult = False; 
DatePickerOptions = { "ShowCalendarIcon" : true, "CalendarIconURL" : "/VARS/Public/themes/cal.bmp" }; oCurrentTheme =  { "SpinnerColour1" : "#2779aa", "SpinnerColour2" : "#e4f1fb", "SpinnerColour3" : "green", "SpinnerIcon" : 8 };  } catch (e) { }

//]]></script>
<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>
</body>
<html lang="en"><head><title>
	VARS Booking Panel
</title><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.css" rel="stylesheet"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css"><link rel="shortcut icon" href="favicon.ico"><link href="../css/bootstrap-select.css" rel="stylesheet">
    <style type="text/css">
        body {
            padding-top: 0px;
            font-size: 12px;

        }
        .form-group {
            margin-bottom: 3px;
        }
        #divRequirementsPanel .input-group {
            padding-bottom: 2px;
        }
        button.ui-datepicker-trigger {
            display: none;
        }
        .modal-back {
            background-color: #ccc;
            border-top-left-radius: 6px;
            border-top-right-radius : 6px;
        }  

       .customTopPadding{
           padding-top:3px !important ;
       }

       .customCurrencyCorners{
           border-radius:4px !important;
       }

    </style>
        <style type="text/css">/*
 * Callouts
 *
 * Not quite alerts, but custom and helpful notes for folks reading the docs.
 * Requires a base and modifier class.
 */

/* Common styles for all types */
.bs-callout {
  padding: 20px;
  margin: 10px 0;
  border: 1px solid #eee;
  border-left-width: 5px;
  border-radius: 3px;
}
.bs-callout h4 {
  margin-top: 0;
  margin-bottom: 5px;
  margin-left: 10px;
}
.bs-callout p:last-child {
  margin-bottom: 0;
}
.bs-callout code {
  border-radius: 3px;
}

/* Tighten up space between multiple callouts */
.bs-callout + .bs-callout {
  margin-top: -5px;
}

/* Variations */
.bs-callout-danger {
  border-left-color: #ce4844;
}
.bs-callout-danger h4 {
  color: #ce4844;
}
.bs-callout-warning {
  border-left-color: #aa6708;
}
.bs-callout-warning h4 {
  color: #aa6708;
}
.bs-callout-info {
  border-left-color: #1b809e;
}
.bs-callout-info h4 {
  color: #1b809e;
}
.bs-callout-success {
  border-left-color: #70bc99;
}
.bs-callout-success h4 {
  color: #70bc99;
}
/* end callout*/


.input-group-addon.cb-beautiful input[type="checkbox"],
.input-group-addon.cb-beautiful input[type="radio"] {
    display: none;
}
.cb-beautiful {
    cursor: pointer;
}
.cb-beautiful span {
    cursor: pointer;
}
</style><style type="text/css">.btn {border-radius: 0px;}
input.form-control {border-radius: 0px;background-color: #fff; color: #000; }
#MMBLoginBody {background-color: #fff;}
#MMBLoginBody {color: #000;}
.modal-header-primary {color: #ffffff; background-color: #0866c6;}.btn-next, .btn-next.dropdown-toggle,.open button.btn-next.dropdown-toggle, .open button.btn-next.dropdown-toggle:focus {border-color: #2d2d2d; background-color: #2d2d2d; color: #ffffff;}
</style>
</head>

<body id="requirementsBody">
    <form method="post" action="./requirementsBS.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTc0NjkwNzAxMQ9kFgYCAw9kFgICAw8WAh4HVmlzaWJsZWhkAgcPFgIeCWlubmVyaHRtbAUSTG9hZGluZyBGbGlnaHRzLi4uZAIJDxYCHwEFC1BsZWFzZSBXYWl0ZGQZ/b7Myfo68EjLFMQmusLLCN2XnYMWAT7MfzuXS6Miwg==">
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="DD9D2F9C">
</div>
    <input type="hidden" id="refreshed" value="no">
    <input type="hidden" id="VarsSessionID" name="VarsSessionID" value="b0a3e04b-f572-4f0c-9528-d1dc5d6949bd" class="">
        
    <div id="divRequirementsPanel" class="divRequirementsPanel form-body form-horizontal"><div class="panel panel-default">
<div class="panel-body">
<input type="hidden" id="rqtm" name="rqtm" value="637594472809126930" class="">
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Origin" id="Origin" class="form-control"><option value="LVI">LIVINGSTONE (LVI)</option><option value="LUN" selected="selected">LUSAKA (LUN)</option><option value="MNS">MANSA (MNS)</option><option value="NLA">NDOLA (NLA)</option>
</select></div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-sm-12 col-xs-12">
<select name="Destination" id="Destination" class="form-control"><option value="LUN">LUSAKA (LUN)</option></select></div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<div class="col-md-12">
<div class="btn-group btn-group-sm" data-toggle="buttons"><label class="btn btn-default btn-outline btn-rounded active"><input name="ReturnTrip" id="ReturnTrip1" type="radio" checked="checked" value="chkJourneyTypeReturn"><i class="fa fa-exchange"></i> Return</label><label class="btn btn-default btn-outline btn-rounded"><input name="ReturnTrip" id="ReturnTrip2" type="radio" value="chkJourneyTypeOneWay"><i class="fa fa-long-arrow-right"></i> One Way</label></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group ">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="departuredate" name="departuredate" value="16-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
<div class="col-md-6 col-sm-6 col-xs-6">
<div class="form-group">
<div class="col-md-12">
<div class="input-group  input-group-sm"><input class="form-control datepicker hasDatepicker" readonly="readonly" type="text" id="returndate" name="returndate" value="20-Jun-2021"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfAdults" id="NumberOfAdults" class="form-control paxSelectControl"><option selected="selected" id="Adults_1" value="1">1 Adults</option><option id="Adults_2" value="2">2 Adults</option><option id="Adults_3" value="3">3 Adults</option><option id="Adults_4" value="4">4 Adults</option><option id="Adults_5" value="5">5 Adults</option><option id="Adults_6" value="6">6 Adults</option><option id="Adults_7" value="7">7 Adults</option><option id="Adults_8" value="8">8 Adults</option><option id="Adults_9" value="9">9 Adults</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfChildren" id="NumberOfChildren" class="form-control paxSelectControl"><option selected="selected" id="Children_0" value="0">0 Children</option><option id="Children_1" value="1">1 Children</option><option id="Children_2" value="2">2 Children</option><option id="Children_3" value="3">3 Children</option><option id="Children_4" value="4">4 Children</option><option id="Children_5" value="5">5 Children</option><option id="Children_6" value="6">6 Children</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
<div class="col-lg-4 col-sm-4 col-xs-6">
<div class="input-group  input-group-sm">
<select name="NumberOfInfants" id="NumberOfInfants" class="form-control paxSelectControl"><option selected="selected" id="Infants_0" value="0">0 Infants</option><option id="Infants_1" value="1">1 Infants</option><option id="Infants_2" value="2">2 Infants</option><option id="Infants_3" value="3">3 Infants</option><option id="Infants_4" value="4">4 Infants</option><option id="Infants_5" value="5">5 Infants</option><option id="Infants_6" value="6">6 Infants</option></select><span class="input-group-addon"><i class="fa fa-male"></i></span></div>
</div>
</div>
<div class="row">
<div class="col-md-6">
<div class="input-group  input-group-sm">
<input class="form-control" type="text" id="EVoucher" placeholder="EVoucher" name="EVoucher"><span class="input-group-addon"><i class="fa fa-tag"></i></span></div>
</div>
</div>
</div>
<div class="panel-footer">
<div class="row">
<div class="col-md-12 text-center">
<div class="input-group  input-group-sm">
<button id="submitButton" class="btn btn-default btn-next" type="submit">Continue</button></div>
</div>
</div>
</div>
</div>
</div>
    <div id="GrandMasterDialog"></div>
    <div id="RequirementsLoadingProgressDialog"></div>
    </form>
       <div id="dialog-message" style="display: none;" title="Information">
        <p>
            <span id="msgSpan">Searching for flights</span>
            <br><br>
        </p>
            <div class="LoadingProgressImage"></div>
    </div>


    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-json/2.5.1/jquery.json.min.js"></script>
    <script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script type="text/javascript">/*
    Flights.js
*/
var fareClassMatch = '';
var ClassBandMustMatch = false;
var UseTraditionalReturnFares = false;

var FlightSelectTranslations = null;
var RequirementsPageTranslations = null;
var divNextPreviousDayAvailability = null;
var mmbChangeFlightMode = '';
var oFirstJourneySelected = null;
var oPreviousFirstJourneyFareSelected = null;
var RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": false };
var FlightSelectNextPage = "BookingOptions.aspx";
var FlightSelectAirMilesValidated = false;
var sEVoucher = "";
var RequirementsEarliestBookingDate = null;
var sOriginCityCode = "";
var sDestinationCityCode = "";
var sHomeCityCode = "";
var sDepartureDate = "";
var sReturnDate = "";
var dDefaultDepartureDate = null;
var dDefaultReturnDate = null;
var RequirementsDefaultDepartureDate = null;
var RequirementsDefaultReturnDate = null;
var RequirementsDoOneShot = null;
var AvUrl = "../WebServices/AvailabilityWS.asmx/GetFlightAvailability";
var DestCityUrl = "../WebServices/Airports.asmx/DestinationCityList";
var addFltUrl = "WebServices/AvailabilityWS.asmx/AddFlightToBasket";
var changeDayUrl = "WebServices/AvailabilityWS.asmx/ChangeDay";

function InitAvailabilityDisplay() {
    try {
        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").parent().unbind("click").click(function () {
            //SelectAvailabilityFare(jQuery(this));
            var rb = $(this).find("input[id^=optCalendarAvailabilityFare][type=radio]");
            $(rb).prop('checked', true);
            SelectAvailabilityFare(jQuery(rb));
            //return false;
        });

        $("#radio-jquery-ui").buttonset();

        jQuery("input[id^=optCalendarAvailabilityFare][type=radio]").unbind("click").click(function () {
            //    SelectAvailabilityFare(jQuery(this));
            //  return false;
        });

        /*
        $(".refineSearchType").unbind("click").click(function () {
            var rb = $(this).find("input[id=ReturnTrip][type=radio]");
            $(rb).prop('checked', true);
           // return false;
        });
        */

        jQuery("div[id^=divFlightAvailabilityPreviousDay], div[id^=divFlightAvailabilityNextDay]").unbind("click").click(function () {
            NextDayPreviousDay_onClick(jQuery(this));
        });


        if (ClassBandMustMatch) {
            if (fareClassMatch !== '') {
                HideOrDisableUnwantedFares('');
            } else {
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 0) {
                    var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                    HideOrDisableUnwantedFares(tempFareData);
                }
            }
        }

        InitialiseRefineSearch(null);
        InitialiseGenericRefineSearch();
    } catch (e) { var xa = 1;}

}
function InitialiseGenericRefineSearch() {
    try {
        $('.dropdown-menu input, .dropdown-menu label, .dropdown-menu select').click(function (e) {
            e.stopPropagation();
        });
    } catch (e) { var xb = 1;}


    try {
        //if (jQuery("div[id$=RefineSearchWhoIsTravelling]").length == 1) {
        jQuery("#NumberOfAdults").change(function () {
            var noAdultsSelected = parseInt(jQuery(this).val());

            if (noAdultsSelected < 0) { noAdultsSelected = 0; }
            if (jQuery("#NumberOfInfants").length > 0) {
                var fldInfants = jQuery("#NumberOfInfants");
                var noOptions = fldInfants.children().length;

                noAdultsSelected += 1;
                if (noOptions > (noAdultsSelected)) {
                    fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
                } else {
                    for (var i = noOptions; ((i < noAdultsSelected) && (i <= RequirementsProperties.MaxInfants)) ; i++) {
                        fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                    }
                }
            }
        });
        //}
    } catch (e) { var xc = 1; }
}
function AddFlightToBasket_onSuccess(msg) {
    if ( msg !== null &&  msg.Data !== "" ) {
        $("#divBasket2").html(msg.Data);
        try { $("#divMiniBasket").html(msg.Data2); } catch (e) { var x4 = 1;}
        try { $("#BandText").html(msg.DialogCaption); } catch (e) { var x3 = 1; }
        try { InitBasket(); } catch (e) { var x = 1;}
        try { OnPageLoad(); } catch (e) { var x1 = 1; }
    }
   // RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
}

function AddFlightToBasket_onError(ErrorMsg) {

    var dlgMsg = new Object;
    dlgMsg.OkAction = "RefreshPage()";
    dlgMsg.html = ErrorMsg;

    modalDialog(dlgMsg);

        //var oButtons = { "Ok": function() {           
        //    // refresh page
        //    //window.location.reload(true);
        //    RefreshPage();
        //    jQuery(this).dialog("destroy");
        //    }
        //};
        //if (RequirementsPageTranslations != null) {
        //    ShowModalDialog(ErrorMsg, RequirementsPageTranslations.ErrorSelectingFlights, 0, 0, oButtons);
        //} else {
        //    ShowModalDialog(ErrorMsg, "Warning", 0, 0, oButtons);
        //}

}

function HideOrDisableUnwantedFares(tempFareData) {
    // disable radio buttons
    var thisClass;
    
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().hide();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().append('<span class="na">NA</span>');

    if (fareClassMatch !== '') {
        thisClass = fareClassMatch;
    } else {
        var vals = tempFareData.split("_");


        if (mmbChangeFlightMode === true) {
            if (jQuery(".FlightAvailabilityTable").length > 1) {
                // enable this direction
                var thisDirection = vals[0] + "_" + vals[1] + "_";
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
            }
        } else {
            // enable this direction
            thisDirection = vals[0] + "_" + vals[1] + "_";
            //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").show();
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().remove(".na");
            jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + thisDirection + "]").parent().children().show();
        }

        // enable this class
        thisClass = "_" + vals[4];
    }
    //jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").show();
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().remove(".na");
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value$=" + thisClass + "]").parent().children().show();

}


function SelectAvailabilityFare(selectedFareOption) {
    var fareData = null;
    var sFormData = "";
    var sPleaseWaitMessage = "";
    var InvalidSelectedFares = "";
    var oRegExp = new RegExp("'", "g");
    var bContinue = true;

    try {
        if (ClassBandMustMatch) {
            if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length === 1) {
                // get code
                var tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").val();
                HideOrDisableUnwantedFares(tempFareData);
            } else if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length > 1) {
                // any radio buttons in jouneys > first, not in first's class, to be de-selected
                tempFareData = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").first().val();
                var vals = tempFareData.split("_");
                var thisClass = vals[4];
                var changes = 0;

                jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var tFareData = jQuery(this).val();
                    vals = tFareData.split("_");
                    if (vals[4] !== thisClass) {
                        $(this).attr("checked", false);
                        changes++;
                    }
                });

                if (changes > 0) {
                    HideOrDisableUnwantedFares(tempFareData);
                }

            }
        }

        if ((jQuery("input:checked[id=RedeemAirMiles]").length === 1) || (jQuery("#chkAvailabilityFFRedeemAirMiles").length === 1)) {
            HideOrDisableExpensiveAirmiles();
        }


       
        var arfareData = [];
        if (UseTraditionalReturnFares) {
            var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
            var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;
            var bValidCombinableFaresSelected = false;

            if (iAvailabilityCount === 2) {
                bContinue = CheckValidReturnCombinableFares(selectedFareOption);
            }
            if ((!bContinue) || (iAvailabilityCount !== iSelectedAvailability)) {
                try { ShowCannedFaxInfo(); } catch (e) { var x = 1;}
                try { highlightSelected(); } catch (e) { var y = 1;}
                return false;
            }

            jQuery("input:checked[id^=optCalendarAvailabilityFare][type=radio]").each(function () {
                var tempFareData = jQuery(this).val();
                tempFareData = tempFareData.toString().replace(oRegExp, "\"");
                InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
                if (InvalidSelectedFares.length > 0) { tempFareData = tempFareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
                if (fareData !== null) {
                    fareData += ", ";
                } else {
                    fareData = "";
                }
                fareData += "'" + tempFareData + "'";
                arfareData.push(tempFareData);
            });
        } else {
            fareData = selectedFareOption.val();
            fareData = fareData.toString().replace(oRegExp, "\"");
            InvalidSelectedFares = CheckValidFareDates(selectedFareOption);
            if (InvalidSelectedFares.length > 0) { fareData = fareData.replace("}", ", \"InvalidSelectedFares\" : " + InvalidSelectedFares + "}"); }
            fareData = "'" + fareData + "'";
            arfareData.push(fareData);
        }

        try { ShowCannedFaxInfo(); } catch (e) { var x1 = 1;}
        try { highlightSelected(); } catch (e) { var x2 = 1;}

        //sFormData = "{ 'FormData': [" + fareData + "] }";
        var rq = new Object;
        rq.addFlightRequest = new Object;
        rq.addFlightRequest.VarsSessionID = $('#VarsSessionID').val();

        rq.addFlightRequest.fareData = arfareData;
        rq.addFlightRequest.Zone = "PUBLIC";

        try { sPleaseWaitMessage = CheckFlightsTranslations.AddingFlightToBasketMessage; } catch (e) { var x3 = 1; }
        var url = addFltUrl;
        if ( (new RegExp("/Agent/", "i")).test(window.location.href) ) {
            // agent page
            url = "../" + url;
            rq.addFlightRequest.Zone = "AGENT";
        }
        if ((new RegExp("/mmb/", "i")).test(window.location.href)  ){
            // mmb page
            url = "../" + url;
            rq.addFlightRequest.Zone = "MMB";
        }
        if ((new RegExp("/fqtv/", "i")).test(window.location.href)) {
            // mmb page
            url = "../" +url;
            rq.addFlightRequest.Zone = "FQTV";
        }

        SendAjaxRequest(url, $.toJSON(rq), null, AddFlightToBasket_onSuccess, AddFlightToBasket_onError, "", true, sPleaseWaitMessage);
    } catch (e) {
        var msg = e.message;
    }
}

function HideOrDisableExpensiveAirmiles() {
    // un-hide any hidden previously
    jQuery("input[type=radio][id^=optCalendarAvailabilityFare]").parent().children().show();

    // do hiding
    jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
        try {
            // get outstanding miles
            var selFare = jQuery(this).val();
            var selFareVals = selFare.split("_");
            var milesSpent = $.trim(jQuery(this).parent().text());
            var totalMilesAvailable = $.trim($(".milesTotal span").html()).replace(",", "");
            if (totalMilesAvailable !== "") {
                // logged in with miles to spend
                var milesLeft = parseInt(totalMilesAvailable, 10) - parseInt(milesSpent, 10)
                var otherDirection;
                if (selFareVals[1] === '0') {
                    otherDirection = selFareVals[0] + "_1_";
                } else {
                    otherDirection = selFareVals[0] + "_0_";
                }
                if (jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").length > 0) {
                    // remove value of existing fare this journey
                    milesLeft += parseInt(jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").val());
                }
                // hide if too expensive
                jQuery("input[type=radio][id^=optCalendarAvailabilityFare][value^=" + otherDirection + "]").each(function () {
                    var miles = parseInt($.trim($(this).parent().text()), 10);
                    if (miles > milesLeft) {
                        $(this).parent().children().hide();
                    }
                });
            }
        } catch (e) { var x = 1;}
    });
}


function ShowCannedFaxInfo() {
    if (onlyShowCannedFaxForSelectedFlight) {
        // hide all canned fax
        $(".InfoColumn").children().hide();
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).each(function () {
            $(this).next().children('.InfoColumn').children().show().removeClass("hidden");
        });
    }
}

function highlightSelected() {
    if (highlightSelectedFlight) {
        // hide all highlighting
        $(".AvailabilityRow, .AvailabilityTableFlightDivider, .AvailabilityTableConnectingFlightDivider, .AvailabilityTableCannedFactsDivider").removeClass('ui-state-highlight');
        $(".AvailabilityRow td, .AvailabilityTableFlightDivider td, .AvailabilityTableConnectingFlightDivider td, .AvailabilityTableCannedFactsDivider td").removeClass('ui-state-highlight');
        // get parent TR, then check if next is InfoColumn
        var par = $("input:checked[id^=optCalendarAvailabilityFare][type=radio]").parent().parent();
        $(par).addClass('ui-state-highlight');
        $(par).children("td").addClass('ui-state-highlight');
        $(par).each(function () {
            CheckHighlightNext(this);
            //if ($(this).hasClass("AvailabilityTableConnectingFlightDivider")) {
            //    $(this).next().addClass('ui-state-highlight');
            //}
        });
    }
}
function CheckHighlightNext(obj) {
    if ($(obj).hasClass("AvailabilityTableConnectingFlightDivider")) {
        $(obj).next().addClass('ui-state-highlight');
        // carry on loop! - careful
        CheckHighlightNext($(obj).next());
    }
}

function CheckValidReturnCombinableFares(selectedFareOption) {
    var fareData = null;
    var selectedFareTable = null;
    var bFareSelected = false;
    var bValidFare = false;
    var bInvalidFareSelected = false;
    var SelectedJourneyFareData = null;

    try {
        oPreviousFirstJourneyFareSelected = null;
        SelectedJourneyFareData = GetFareObjectData(selectedFareOption.get(0));
        var bIsCombinableFare = SelectedJourneyFareData.IsCombinableFareClass;
        var bHasReturnFare = SelectedJourneyFareData.FareClassHasReturnFare;
        if (oFirstJourneySelected === null) {
            oFirstJourneySelected = SelectedJourneyFareData.FlightAvailabilityTableClientID;
        } else {
            if (SelectedJourneyFareData.FlightAvailabilityTableClientID !== oFirstJourneySelected) return true;
        }

        jQuery("table[id^=tblFlightAvailability]").each(function () {
            var oTable = jQuery(this);
            if (oTable.attr("id") !== SelectedJourneyFareData.FlightAvailabilityTableClientID) { //selectedFareTable.attr("id")
                oTable.find("input[type=radio][id^=optCalendarAvailabilityFare]").each(function () {
                    var fareObject = jQuery(this).get(0);
                    var fareObjectData = GetFareObjectData(fareObject);

                    bFareSelected = fareObject.checked;
                    bValidFare = false;
                    if ((bIsCombinableFare) && (fareObjectData.IsCombinableFareClass)) {
                        bValidFare = true;
                    } else {
                        if ((bHasReturnFare) && ((new RegExp(SelectedJourneyFareData.SelectedFareClass, "i")).test(fareObjectData.SelectedFareClass))) {
                            var sReturnFareRoute = "";
                            if (SelectedJourneyFareData.FlightAvailabilityTableClientID === "tblFlightAvailability0_0_0") {
                                sReturnFareRoute = SelectedJourneyFareData.FareRoute + fareObjectData.FareRoute.substr(3);
                            } else {
                                sReturnFareRoute = fareObjectData.FareRoute + SelectedJourneyFareData.FareRoute.substr(3);
                            }

                            if ((new RegExp(sReturnFareRoute, "i")).test(SelectedJourneyFareData.ReturnFareRoutes)) {
                                bValidFare = true;
                            }
                        }
                    }

                    if (!bValidFare) {
                        if (!bInvalidFareSelected && bFareSelected) { bInvalidFareSelected = true; }
                        fareObject.checked = false;
                    }
                    fareObject.disabled = !bValidFare;
                });
            }
        });

        //return false;
        if (bInvalidFareSelected) {
            oPreviousFirstJourneyFareSelected = selectedFareOption;
            jQuery("#divEmptyShoppingBasket").unbind("click").click();
            return true;
        } else {
            return true;
        }
    } catch (e) { var x = 1;}
}

function GetFareObjectData(fareObject) {
    var fareObjectData = null;
    var oRegExp = new RegExp("'", "g");

    try {
        fareObjectData = jQuery.parseJSON(fareObject.value.toString().replace(oRegExp, "\""));
        var sID_Indices = fareObject.id.replace("optCalendarAvailabilityFare", "") + "_" + fareObjectData.JourneyIndex + "_" + fareObjectData.FlightLegIndex;
        var fareObjectDateField = jQuery("#hfldCalendarAvailabilityDepDateTime" + sID_Indices);
        fareObjectData.SelectedFareDate = Date.parse(fareObjectDateField.val());
        fareObjectData.FlightDuration = jQuery("#hfldCalendarAvailabilityDuration" + sID_Indices).val();
        fareObjectData.MinConnectionTime = jQuery("#hfldCalendarAvailabilityMinConnectionTime" + sID_Indices).val();
    } catch (e) {
        fareObjectData = new Object;

    }

    return fareObjectData;
}

function ValidateSelectedFlights() {
    try {
        var iAvailabilityCount = jQuery("div[id^=divAvailabilityPanel]").length;
        var iSelectedAvailability = jQuery("input:checked[type=radio][id^=optCalendarAvailabilityFare]").length;

        //        if (ShoppingBasket2.UseBasket2 == true) {
        if ((!ShoppingBasket2.IsBasketEmpty) && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount) {
            return true;
        }
        if (iSelectedAvailability === 0) {
            try { modalDialog(flightSelectPageTranslationsMsgs.FlightSelectionErrorMessage); } catch (e) {var x = 1;}
            return false;
        }
        if ((iAvailabilityCount > 1) && (iSelectedAvailability > 0) && (iSelectedAvailability !== iAvailabilityCount)) {
            try { modalDialog(flightSelectPageTranslationsMsgs.ReturnFlightSelectionErrorMessage); } catch (e) {                var x5 = 1;}
            return false;

        }

            return (!ShoppingBasket2.IsBasketEmpty && iSelectedAvailability > 0 && iSelectedAvailability === iAvailabilityCount);
        //} else {
        //    return ((!oCurrentShoppingBasket.IsBasketEmpty) && (iSelectedAvailability > 0) && (iSelectedAvailability == iAvailabilityCount));
        //}
    } catch (e) {
        return false;
    }
}

function ToggleFlightAvailabilityAirMilesMode_onSuccess(msg) {
    try {
        if (msg.Data !== null && msg.Data.length > 0) {
            jQuery("div[id$=divFlightAvailabilityFound]").html(msg.Data);
            // InitialiseCheckFlightsObjects(null);
            RefreshControl("Basket", "#divBasket2", null, "NORELOAD");
            InitAvailabilityDisplay();
        }
    } catch (e) {        var x = 1; }
}

function GetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
        $("#Destination").val(sDestinationCityCode);
    } catch (e) {        var x = 1; }

}

function InitRequirements() {

    $('.requirementsInnerContent').show();
    //KeepAlive();

    if (RequirementsDoOneShot === true) {
        SendAjaxRequest("../WebServices/Airports.asmx/OneShotLoad", "", "html", RequirementsOneShotLoad_onSuccess, null, "");
    }


    $(".requirementsLabel").unbind("click").click(function () {
    });

    $("#radio-jquery-ui").buttonset();

    try { InitialiseDatePicker(); } catch (e) {        var x = 1;}

    if (RequirementsEarliestBookingDate !== null) {
        jQuery("#departuredate, #returndate").datepicker("option", "minDate", RequirementsEarliestBookingDate);
    }

    if (RequirementsDefaultDepartureDate !== null && jQuery("#departuredate").datepicker("getDate") !== RequirementsDefaultDepartureDate) {
        jQuery("#departuredate").datepicker("setDate", RequirementsDefaultDepartureDate);
    }

    if (RequirementsDefaultReturnDate !== null && jQuery("input[name=ReturnTrip]:radio:checked").length === 1) {
        jQuery("#returndate").datepicker("setDate", RequirementsDefaultReturnDate);
    }

    jQuery("#departuredate").change(function () {
        var dSelectedDepartureDate = jQuery(this).datepicker("getDate");
        jQuery("#returndate").datepicker("option", "minDate", dSelectedDepartureDate);
        if (jQuery('input[name=ReturnTrip]:radio:checked').val() === 'chkJourneyTypeReturn' && jQuery("#returndate").val().length === 0) {
            jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate);
        }
        try { if (RequirementsProperties.AutoUpdateReturnDate !== null) { jQuery("#returndate").datepicker("setDate", dSelectedDepartureDate.addDays(RequirementsProperties.AutoUpdateReturnDate)); } }
        catch (e) {
            var x = 1;
    }
    });

    jQuery("#NumberOfAdults").change(function () {
        var noAdultsSelected = parseInt(jQuery(this).val());

        if (noAdultsSelected < 0) { noAdultsSelected = 0; }
        if (jQuery("#NumberOfInfants").length > 0) {
            var fldInfants = jQuery("#NumberOfInfants");
            var noOptions = fldInfants.children().length;

            noAdultsSelected += 1;
            if (noOptions > noAdultsSelected) {
                fldInfants.find("option:gt(" + (noAdultsSelected - 1).toString() + ")").remove();
            } else {
                for (var i = noOptions; (i < noAdultsSelected && i <= RequirementsProperties.MaxInfants) ; i++) {
                    fldInfants.append("<option value\"" + i.toString() + "\">" + i.toString() + "</option>");
                }
            }
        }
    });

    $('#Origin').change(function () {
        SendAjaxRequest(DestCityUrl, "{'origin':'" + $('#Origin').val() + "'}", "html", RequirementsGetDestinations_onSuccess, null, "");
    });

    $('input[name=ReturnTrip]:radio').change(function () {
        if ($('input[name=ReturnTrip]:radio:checked').val() !== 'chkJourneyTypeReturn')
            $('.requirementsReturning').hide();
        else
            $('.requirementsReturning').show();
    });

    $('#submitButton').click(function (e) {

        var wsRq = BuildAvSearch(e);
        wsRq.SearchUser = "PUBLIC";
        if (wsRq !== false) {
            var sFormData = '{"FormData":' + $.toJSON(wsRq) + ',"IsMMBChangeFlightMode":false, "IsRefineSerach": false}';

            SendAjaxRequest(AvUrl, sFormData, null, RequirementsDoSubmit_onSuccess, RequirementsDoSubmit_onError, null, true, null);
        }
        return false;
    });
    // hover effects
    jQuery(".ui-button.ui-state-active").hover(
        function () { jQuery(this).removeClass("ui-state-active").addClass("ui-state-hover"); },
        function () { jQuery(this).removeClass("ui-state-hover").addClass("ui-state-active"); }
    ); //end hover
    InitChildCheck();
}

function InitChildCheck() {
    try {
        if (ChildNeedsAdult == true ) {
            // check on change no children
            $("#NumberOfChildren").unbind("change").change(function (e) {
                var noSelected = parseInt(jQuery(this).val());
                if (noSelected > 0) {
                    $("#Adults_0").wrap('<span/>');
                } else {
                    $("#Adults_0").unwrap();
                }
            });

            // check current settings
            DoChildCheck($("#NumberOfChildren"));
        }
    }
    catch (e) {
        
    }    
}
function DoChildCheck(obj) {
    var noSelected = parseInt(jQuery(obj).val());
    if (noSelected > 0) {
        $("#Adults_0").wrap('<span/>');
    
    }
}



//function GetHomeCity_onSuccess(msg) {

//    try {
//        sHomeCityCode = msg;
//    } catch (e) { }

//}

function GetOrigins_onSuccess(msg) {

    try {
        $("#Origin").html(msg);
        $("#Origin").val(sHomeCityCode);
        $("#Origin").change();
    } catch (e) {
        var x = 1;
    }

}

function RequirementsOneShotLoad_onSuccess(msg) {

    try {
        var o = jQuery.parseJSON(msg);

        sHomeCityCode = o.HomeCity;
        $("#Origin").html(o.OriginList);
        if (o.SelectedOriginCity.length > 0) {
            $("#Origin").val(o.SelectedOriginCity);
        } else {
            $("#Origin").val(sHomeCityCode);
        }
        $("#Destination").html(o.DestinationList);
        if (o.SelectedDestinationCity.length > 0) { $("#Destination").val(o.SelectedDestinationCity); }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsGetDestinations_onSuccess(msg) {

    try {
        $("#Destination").html(msg);
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onSuccess(msg) {

    try {
        if (msg.Result === 'OK') {
            if (msg.NextURL !== '') {
                switch ($('#formRequirements').attr('target')) {
                    case '_blank':
                        window.open(msg.NextURL);
                        break;
                    case '_top':
                    default:
                        // window.top.location = msg.NextURL; // +"?VarsSessionID=" + $("#VarsSessionID").val(); 
                        PostToPage(msg.NextURL);
                }
                try { ShowLoadingProgressDialog(RequirementsPageTranslations.LoadingFlightsMessage); } catch (e) { var xv = 1;}
            }
        } else {
            // ShowRequirementsModalDialog(msg.ErrorMsg);
            WsServerErrorDialog(msg);
        }
    } catch (e) {
        var x = 1;
    }

}

function RequirementsDoSubmit_onError(errorText, msg) {

    try {
        var $p = $('<p class="RequirementsDialog"></p>').hide().appendTo("body");
        var dlgH = parseInt($p.css("height").replace("px", ""), 10);
        var dlgW = parseInt($p.css("width").replace("px", ""), 10);
        $p.remove();

        ShowModalDialog(errorText, "Search Error", dlgH, dlgW);

    } catch (e) {
        var x = 1;

    }

}

</script><script type="text/javascript">function InitBeautifulCheckbox() {
    $('.input-group-addon.cb-beautiful').each(function () {

        var $widget = $(this),
            $input = $widget.find('input'),
            type = $input.attr('type');
        settings = {
            checkbox: {
                on: { icon: 'fa fa-1-5x fa-check-square-o' },
                off: { icon: 'fa fa-1-5x fa-square-o' }
            },
            radio: {
                on: { icon: 'fa fa-dot-circle-o' },
                off: { icon: 'fa fa-circle-o' }
            }
        };
        if ($widget.find('span').length == 0) {
            $widget.prepend('<span class="' + settings[type].off.icon + '"></span>');
        }
        $widget.unbind("click").click(function () {
            $input.prop('checked', !$input.is(':checked'));
            $input.trigger("change");
            updateDisplay();
        });

        function updateDisplay() {
            var isChecked = $input.is(':checked') ? 'on' : 'off';

            $widget.find('.fa').attr('class', settings[type][isChecked].icon);

            //Just for desplay
            //isChecked = $input.is(':checked') ? 'checked' : 'not Checked';
            //$widget.closest('.input-group').find('input[type="text"]').val('Input is currently ' + isChecked)
        }

        updateDisplay();
    });
}

jQuery(document).ready(function () {
    InitBeautifulCheckbox();
});
</script><script type="text/javascript">/**
 * bootbox.js v4.4.0
 *
 * http://bootboxjs.com/license.txt
 */
!function (a, b) { "use strict"; "function" == typeof define && define.amd ? define(["jquery"], b) : "object" == typeof exports ? module.exports = b(require("jquery")) : a.bootbox = b(a.jQuery) }(this, function a(b, c) { "use strict"; function d(a) { var b = q[o.locale]; return b ? b[a] : q.en[a] } function e(a, c, d) { a.stopPropagation(), a.preventDefault(); var e = b.isFunction(d) && d.call(c, a) === !1; e || c.modal("hide") } function f(a) { var b, c = 0; for (b in a) c++; return c } function g(a, c) { var d = 0; b.each(a, function (a, b) { c(a, b, d++) }) } function h(a) { var c, d; if ("object" != typeof a) throw new Error("Please supply an object of options"); if (!a.message) throw new Error("Please specify a message"); return a = b.extend({}, o, a), a.buttons || (a.buttons = {}), c = a.buttons, d = f(c), g(c, function (a, e, f) { if (b.isFunction(e) && (e = c[a] = { callback: e }), "object" !== b.type(e)) throw new Error("button with key " + a + " must be an object"); e.label || (e.label = a), e.className || (e.className = 2 >= d && f === d - 1 ? "btn-primary" : "btn-default") }), a } function i(a, b) { var c = a.length, d = {}; if (1 > c || c > 2) throw new Error("Invalid argument length"); return 2 === c || "string" == typeof a[0] ? (d[b[0]] = a[0], d[b[1]] = a[1]) : d = a[0], d } function j(a, c, d) { return b.extend(!0, {}, a, i(c, d)) } function k(a, b, c, d) { var e = { className: "bootbox-" + a, buttons: l.apply(null, b) }; return m(j(e, d, c), b) } function l() { for (var a = {}, b = 0, c = arguments.length; c > b; b++) { var e = arguments[b], f = e.toLowerCase(), g = e.toUpperCase(); a[f] = { label: d(g) } } return a } function m(a, b) { var d = {}; return g(b, function (a, b) { d[b] = !0 }), g(a.buttons, function (a) { if (d[a] === c) throw new Error("button key " + a + " is not allowed (options are " + b.join("\n") + ")") }), a } var n = { dialog: "<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>", header: "<div class='modal-header modal-header-primary'><h4 class='modal-title'></h4></div>", footer: "<div class='modal-footer'></div>", closeButton: "<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>", form: "<form class='bootbox-form'></form>", inputs: { text: "<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />", textarea: "<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>", email: "<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />", select: "<select class='bootbox-input bootbox-input-select form-control'></select>", checkbox: "<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>", date: "<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />", time: "<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />", number: "<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />", password: "<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />" } }, o = { locale: "en", backdrop: "static", animate: !0, className: null, closeButton: !0, show: !0, container: "body" }, p = {}; p.alert = function () { var a; if (a = k("alert", ["ok"], ["message", "callback"], arguments), a.callback && !b.isFunction(a.callback)) throw new Error("alert requires callback property to be a function when provided"); return a.buttons.ok.callback = a.onEscape = function () { return b.isFunction(a.callback) ? a.callback.call(this) : !0 }, p.dialog(a) }, p.confirm = function () { var a; if (a = k("confirm", ["cancel", "confirm"], ["message", "callback"], arguments), a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, !1) }, a.buttons.confirm.callback = function () { return a.callback.call(this, !0) }, !b.isFunction(a.callback)) throw new Error("confirm requires a callback"); return p.dialog(a) }, p.prompt = function () { var a, d, e, f, h, i, k; if (f = b(n.form), d = { className: "bootbox-prompt", buttons: l("cancel", "confirm"), value: "", inputType: "text" }, a = m(j(d, arguments, ["title", "callback"]), ["cancel", "confirm"]), i = a.show === c ? !0 : a.show, a.message = f, a.buttons.cancel.callback = a.onEscape = function () { return a.callback.call(this, null) }, a.buttons.confirm.callback = function () { var c; switch (a.inputType) { case "text": case "textarea": case "email": case "select": case "date": case "time": case "number": case "password": c = h.val(); break; case "checkbox": var d = h.find("input:checked"); c = [], g(d, function (a, d) { c.push(b(d).val()) }) } return a.callback.call(this, c) }, a.show = !1, !a.title) throw new Error("prompt requires a title"); if (!b.isFunction(a.callback)) throw new Error("prompt requires a callback"); if (!n.inputs[a.inputType]) throw new Error("invalid prompt type"); switch (h = b(n.inputs[a.inputType]), a.inputType) { case "text": case "textarea": case "email": case "date": case "time": case "number": case "password": h.val(a.value); break; case "select": var o = {}; if (k = a.inputOptions || [], !b.isArray(k)) throw new Error("Please pass an array of input options"); if (!k.length) throw new Error("prompt with select requires options"); g(k, function (a, d) { var e = h; if (d.value === c || d.text === c) throw new Error("given options in wrong format"); d.group && (o[d.group] || (o[d.group] = b("<optgroup/>").attr("label", d.group)), e = o[d.group]), e.append("<option value='" + d.value + "'>" + d.text + "</option>") }), g(o, function (a, b) { h.append(b) }), h.val(a.value); break; case "checkbox": var q = b.isArray(a.value) ? a.value : [a.value]; if (k = a.inputOptions || [], !k.length) throw new Error("prompt with checkbox requires options"); if (!k[0].value || !k[0].text) throw new Error("given options in wrong format"); h = b("<div/>"), g(k, function (c, d) { var e = b(n.inputs[a.inputType]); e.find("input").attr("value", d.value), e.find("label").append(d.text), g(q, function (a, b) { b === d.value && e.find("input").prop("checked", !0) }), h.append(e) }) } return a.placeholder && h.attr("placeholder", a.placeholder), a.pattern && h.attr("pattern", a.pattern), a.maxlength && h.attr("maxlength", a.maxlength), f.append(h), f.on("submit", function (a) { a.preventDefault(), a.stopPropagation(), e.find(".btn-primary").click() }), e = p.dialog(a), e.off("shown.bs.modal"), e.on("shown.bs.modal", function () { h.focus() }), i === !0 && e.modal("show"), e }, p.dialog = function (a) { a = h(a); var d = b(n.dialog), f = d.find(".modal-dialog"), i = d.find(".modal-body"), j = a.buttons, k = "", l = { onEscape: a.onEscape }; if (b.fn.modal === c) throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details."); if (g(j, function (a, b) { k += "<button data-bb-handler='" + a + "' type='button' class='btn " + b.className + "'>" + b.label + "</button>", l[a] = b.callback }), i.find(".bootbox-body").html(a.message), a.animate === !0 && d.addClass("fade"), a.className && d.addClass(a.className), "large" === a.size ? f.addClass("modal-lg") : "small" === a.size && f.addClass("modal-sm"), a.title && i.before(n.header), a.closeButton) { var m = b(n.closeButton); a.title ? d.find(".modal-header").prepend(m) : m.css("margin-top", "-10px").prependTo(i) } return a.title && d.find(".modal-title").html(a.title), k.length && (i.after(n.footer), d.find(".modal-footer").html(k)), d.on("hidden.bs.modal", function (a) { a.target === this && d.remove() }), d.on("shown.bs.modal", function () { d.find(".btn-primary:first").focus() }), "static" !== a.backdrop && d.on("click.dismiss.bs.modal", function (a) { d.children(".modal-backdrop").length && (a.currentTarget = d.children(".modal-backdrop").get(0)), a.target === a.currentTarget && d.trigger("escape.close.bb") }), d.on("escape.close.bb", function (a) { l.onEscape && e(a, d, l.onEscape) }), d.on("click", ".modal-footer button", function (a) { var c = b(this).data("bb-handler"); e(a, d, l[c]) }), d.on("click", ".bootbox-close-button", function (a) { e(a, d, l.onEscape) }), d.on("keyup", function (a) { 27 === a.which && d.trigger("escape.close.bb") }), b(a.container).append(d), d.modal({ backdrop: a.backdrop ? "static" : !1, keyboard: !1, show: !1 }), a.show && d.modal("show"), d }, p.setDefaults = function () { var a = {}; 2 === arguments.length ? a[arguments[0]] = arguments[1] : a = arguments[0], b.extend(o, a) }, p.hideAll = function () { return b(".bootbox").modal("hide"), p }; var q = { br: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Sim" },  da: { OK: "OK", CANCEL: "Annuller", CONFIRM: "Accepter" }, de: { OK: "OK", CANCEL: "Abbrechen", CONFIRM: "Akzeptieren" },  en: { OK: "OK", CANCEL: "Cancel", CONFIRM: "OK" }, es: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Aceptar" }, et: { OK: "OK", CANCEL: "Katkesta", CONFIRM: "OK" }, fi: { OK: "OK", CANCEL: "Peruuta", CONFIRM: "OK" }, fr: { OK: "OK", CANCEL: "Annuler", CONFIRM: "D'accord" },  hr: { OK: "OK", CANCEL: "Odustani", CONFIRM: "Potvrdi" }, id: { OK: "OK", CANCEL: "Batal", CONFIRM: "OK" }, it: { OK: "OK", CANCEL: "Annulla", CONFIRM: "Conferma" },  nl: { OK: "OK", CANCEL: "Annuleren", CONFIRM: "Accepteren" }, no: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, pl: { OK: "OK", CANCEL: "Anuluj", CONFIRM: "PotwierdÅº" }, pt: { OK: "OK", CANCEL: "Cancelar", CONFIRM: "Confirmar" },  sq: { OK: "OK", CANCEL: "Anulo", CONFIRM: "Prano" }, sv: { OK: "OK", CANCEL: "Avbryt", CONFIRM: "OK" }, }; return p.addLocale = function (a, c) { return b.each(["OK", "CANCEL", "CONFIRM"], function (a, b) { if (!c[b]) throw new Error("Please supply a translation for '" + b + "'") }), q[a] = { OK: c.OK, CANCEL: c.CANCEL, CONFIRM: c.CONFIRM }, p }, p.removeLocale = function (a) { return delete q[a], p }, p.setLocale = function (a) { return p.setDefaults("locale", a) }, p.init = function (c) { return a(c || b) }, p });
</script><script type="text/javascript" src="../js/requirements.js"></script>
        <script type="text/javascript" src="../js/jquery/lobibox.js"></script>
        <script type="text/javascript" src="quickload.js"></script>

<div id="spinnerModal" class="modal fade" data-backdrop="static" data-keyboard="false">
<div class="modal-dialog spinner">
<div class="modal-content">
<div class="modal-header modal-back modal-header-primary" style="padding-bottom: 5px;padding-top:5px; border-top-right-radius: 5px; border-top-left-radius: 5px;">
    <h3 id="myModalLabel" style="padding-top: 5px; padding-bottom: 5px; margin-top: 0px; margin-bottom: 0px;">Loading Flights...</h3></div>
<div class="modal-body"> 
<i class="fa fa-refresh fa-spin fa-2x"></i><span id="PleaseWaitSpan" style="padding-left:30px;">Please Wait</span>
</div>
</div> 
</div></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
     <script type="text/javascript">
                $(document).ready(function () {
                    $('.selectpicker').selectpicker();
                });
        </script>


<script type="text/javascript">//<![CDATA[

var ChildNeedsAdult = false; 
try {
UserCurrentLanguage = "";var onlyShowCannedFaxForSelectedFlight = false;
var highlightSelectedFlight = true;

 } catch (e) { }

//]]></script>
<script type="text/javascript">//<![CDATA[

try {
WantQuickPanels = true;
var routes = []; 
routes.push({org: 'LVI', dest: ["LUN|LUSAKA (LUN)"]  });
routes.push({org: 'LUN', dest: ["LVI|LIVINGSTONE (LVI)","MNS|MANSA (MNS)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'MNS', dest: ["LUN|LUSAKA (LUN)","NLA|NDOLA (NLA)"]  });
routes.push({org: 'NLA', dest: ["LUN|LUSAKA (LUN)","MNS|MANSA (MNS)"]  });

var RequirementsPageTranslations = {"NoDepartureDateError" : "Please select a departure date.", "NoReturnDateError" : "Please select a return date.", "DateOrderError" : "Please select a return date after the departure date.", "LoadingFlightsMessage" : "Please wait <br />Loading flights...", "ErrorSelectingFlights" : "Error selecting flights", "MaxPassengersErrorMessage" : "The maximum number of passengers allowed in a booking is limited to ", "LargerGroupsErrorMessage" : "For larger groups, please call ..."};
RequirementsDefaultPleaseWaitMessage = "Please wait...";DefaultPleaseWaitMessage = "Please wait...";RequirementsIE6Error = "Your browser is not supported.<br /> Internet Explorer 7 is the minimum supported version. ";RequirementsDefaultErrorMessage = "An error has occurred, please contact customer services.";RequirementsCurrentLanguage = "";RequirementsDoOneShot =  false, UserCurrentLanguage = "";RequirementsEarliestBookingDate = new Date(2021, 5, 16, 0, 0, 0);RequirementsDefaultDepartureDate = new Date(0001, 0, 01, 0, 0, 0);RequirementsDefaultReturnDate = new Date(0001, 0, 01, 0, 0, 0);
RequirementsProperties = { "MaxPassengers": null, "MaxChildren": 6, "MaxInfants": 6, "AutoUpdateReturnDate": null, "RequirementsPage": "CustomerPanels/Requirements.aspx", "IsMultiCityBooking": false }; var SelectPaxMessage = "Please select who is travelling" ;ChildNeedsAdult = False; 
DatePickerOptions = { "ShowCalendarIcon" : true, "CalendarIconURL" : "/VARS/Public/themes/cal.bmp" }; oCurrentTheme =  { "SpinnerColour1" : "#2779aa", "SpinnerColour2" : "#e4f1fb", "SpinnerColour3" : "green", "SpinnerIcon" : 8 };  } catch (e) { }

//]]></script>
<div id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>
</body>
</html>
" "
<iframe loading="lazy" src="https://booking.mahoganyair.com/vars/public/CustomerPanels/requirementsBS.aspx" height="315" width="560" allowfullscreen="" frameborder="0">
</iframe>
<div>
   </div>



